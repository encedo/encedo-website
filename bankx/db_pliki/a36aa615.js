;var dbnextPrepaidModule=angular.module("dbnext-prepaid",["ebanking-shared"]).config(["translationsLoaderProvider","$urlRouterProvider","guiProvider","pathServiceProvider","stateServiceProvider",function(a,b,c,d,e){var f="de",g="dbnext",h="prepaid",i=g+"."+h,j=g+"-"+h,k=f+"."+h;webComponentRegistry[j].simpleName=h,webComponentRegistry[j].startState=k+".content.realized",c.registerElement(j),c.registerElement(j,"menu"),c.registerElement(j,"product","default"),a.addTranslationsPath(d.generateRootPath(j)+"/i18n/messages_{{language}}.json"),b.when("/"+f+"/"+h,"/"+f+"/"+h+"/content/realized"),e.state(f,{url:"/"+f,"abstract":!0,template:"<div ui-view></div>"}).state(k,{url:"/"+h,"abstract":!0,templateUrl:d.generateTemplatePath(j)+"/views/prepaidView.html",controller:i+".ViewController"}).state(k+".content",{url:"/content",templateUrl:d.generateTemplatePath(j)+"/views/prepaidContent.html",controller:i+".ContentController"}).state(k+".content.realized",{url:"/realized",templateUrl:d.generateTemplatePath(j)+"/views/prepaidContentTab.html",controller:i+".RealizedContentController"}).state(k+".content.rejected",{url:"/rejected",templateUrl:d.generateTemplatePath(j)+"/views/prepaidContentTab.html",controller:i+".RejectedContentController"}).state(k+".content.canceled",{url:"/canceled",templateUrl:d.generateTemplatePath(j)+"/views/prepaidContentTab.html",controller:i+".TerminatedContentController"}).state(k+".content.waiting",{url:"/waiting",templateUrl:d.generateTemplatePath(j)+"/views/prepaidContentTab.html",controller:i+".WaitingContentController"}).state(k+".form",{url:"/form",templateUrl:d.generateTemplatePath(j)+"/views/prepaidForm.html",controller:i+".FormController","abstract":!0}).state(k+".form.new",{url:"/new",templateUrl:d.generateTemplatePath(j)+"/views/prepaidFormNew.html"}).state(k+".cancel",{url:"/:dispositionId/cancel",templateUrl:d.generateTemplatePath(j)+"/views/prepaidCancel.html",controller:i+".CancelController"}).state(k+".accept",{url:"/accept",templateUrl:d.generateTemplatePath(j)+"/views/prepaidAccept.html",controller:i+".AcceptController","abstract":!0}).state(k+".accept.new",{url:"/:dispositionId/accept",templateUrl:d.generateTemplatePath(j)+"/views/prepaidAcceptNew.html",previous:[k+".form.new"]}).state(k+".content.details",{url:"/:id/details",templateUrl:d.generateTemplatePath(j)+"/views/prepaidDetails.html",controller:i+".DetailsController"}).state(k+".templates",{url:"/templates",templateUrl:d.generateTemplatePath(j)+"/views/prepaidTemplates.html",controller:i+".TemplatesController"}).state(k+".templatesDetails",{url:"/:templateId/details",templateUrl:d.generateTemplatePath(j)+"/views/prepaidTemplateDetails.html",controller:i+".TemplateDetailsController",previous:[k+".templates"]}).state(k+".templatesDelete",{url:"/:templateId/delete",templateUrl:d.generateTemplatePath(j)+"/views/prepaidTemplateDelete.html",controller:i+".TemplateDeleteController",previous:[k+".templates"]}).state(k+".templatesForm",{url:"/templates/form",templateUrl:d.generateTemplatePath(j)+"/views/prepaidTemplateForm.html",controller:i+".TemplateFormController","abstract":!0}).state(k+".templatesForm.new",{url:"/new",templateUrl:d.generateTemplatePath(j)+"/views/prepaidTemplateFormNew.html"}).state(k+".templateAccept",{url:"/templateAccept",templateUrl:d.generateTemplatePath(j)+"/views/prepaidTemplateAcceptForm.html",controller:i+".TemplateAcceptController","abstract":!0}).state(k+".templateAccept.new",{url:"/:templateOrderId/template",templateUrl:d.generateTemplatePath(j)+"/views/prepaidTemplateAcceptFormNew.html"}).state(k+".content.prepaidInfo",{url:"/prepaid_info",templateUrl:d.generateTemplatePath(j)+"/views/prepaidInfo.html",controller:i+".PrepaidInfoController"})}]).run(["$rootScope","$state",function(a,b){a.$on("$stateChangeStart",function(a,c,d,e,f){var g=e.name,h=c.name;""!=g&&angular.isDefined(c.previous)&&-1==c.previous.indexOf(g)&&(a.preventDefault(),-1!=h.indexOf(webComponentRegistry["dbnext-prepaid"].simpleName)&&b.go(webComponentRegistry["dbnext-prepaid"].startState))})}]);dbnextPrepaidModule.controller("dbnext.prepaid.AcceptController",["$scope","notificationService","$state","initialState","userService","staticFind","viewStateService","prepaidConfirmationService","prepaidService","accountsService","formService",function(a,b,c,d,e,f,g,h,i,j,k){a.$parent.details=!0,a.currentTabState=g.getInitialState("currentTabState"),null==a.currentTabState&&(a.currentTabState={stateName:"de.prepaid.content.realized"});var d=g.getInitialState(c.current.name);a.paymentPromise=i.get(c.params.dispositionId).then(function(b){a.paymentDetails=b,a.auth={},a.text={auth_method:"db.prepaid.new.step2.row.auth.label.",no_auth_required:"db.prepaid.new.step2.row.auth.no_authorization_required",tan_validate_required:"db.prepaid.new.step2.row.auth.tan.validate.required",sms_validate_required:"db.prepaid.new.step2.row.auth.sms.validate.required",token_validate_required:"db.prepaid.new.step2.row.auth.token.validate.required",input_placeholders:"db.prepaid.new.step2.row.auth.placeholder.",error_code_validate:"db.config.auth.error_code.validate."},"INTRODUCED"!=a.paymentDetails.status&&c.go("de.prepaid.content.waiting"),d&&d.exchange&&(a.exchange=d.exchange)}),a.accept=function(d){return angular.element(document.querySelector(":focus")).triggerHandler("blur"),d.$valid?(a.errorCode=null,i.action({authenticationAttemptId:a.auth.authenticationAttemptId,credentials:a.auth.credentials,transferId:c.params.dispositionId},"accept_prepaid_transfer",a.paymentDetails).then(function(){var a={fields:"id,amount,status,currency,lastRealizationDesc"};return i.get(c.params.dispositionId,a).then(function(a){g.resetAllStates(),c.go("de.prepaid.content.waiting"),b.showTopUpAcceptedDialog({text:{message:"db.prepaid.new.step2.confirmation.message",title:"db.prepaid.new.step2.confirmation.title",createNew:"db.prepaid.new.step2.confirmation.create_new",back:"db.prepaid.new.step2.confirmation.back"},state:{dashboard:"de.dashboard",back:"de.prepaid.form.new"}})})},function(b){var c=/([a-zA-Z])/;a.errorCode=c.test(b.text)?"":b.text})):void k.dirtyFields(d)},a.change=function(){c.go("de.prepaid.form.new")},a.getPaymentTypeKey=function(a){return null!=a?paymentType.getPaymentTypeKey(a):void 0},a.saveToShoppingOrder=function(a){angular.element(document.querySelector(":focus")).triggerHandler("blur"),a.$valid||k.dirtyFields(a)}}]),dbnextPrepaidModule.controller("dbnext.prepaid.CancelController",["$scope","$state","$log","$stateParams","viewStateService","notificationService","prepaidService","initialState","pathService",function(a,b,c,d,e,f,g,h,i){return a.pathPrefix=i.generateTemplatePath("dbnext-prepaid"),a.$parent.details=!0,angular.isDefined(h)?(a.prepaidPromise=g.get(h.prepaidId).then(function(c){a.prepaidDetails=c,a.auth={},"INTRODUCED"!=a.prepaidDetails.status&&"WAITING"!=a.prepaidDetails.status&&b.go("de.prepaid.content.waiting")},function(b){c.error("Error getting payment details"),a.prepaidDetails=null}),void(a.accept=function(c){return angular.element(document.querySelector(":focus")).triggerHandler("blur"),c.$valid?(a.errorCode=null,g.action({authenticationAttemptId:a.auth.authenticationAttemptId,credentials:a.auth.credentials,transferId:b.params.dispositionId},"cancel_prepaid_transfer",a.prepaidDetails).then(function(){e.resetAllStates(),b.go("de.prepaid.content.waiting"),f.showTopUpAcceptedDialog({text:{message:"db.prepaid.cancel.confirmation.message",title:"db.prepaid.cancel.confirmation.title",createNew:"db.prepaid.cancel.confirmation.create_new",back:"db.prepaid.cancel.confirmation.back"},state:{dashboard:"de.dashboard",back:"de.prepaid.form.new"}})},function(c){var d=/([a-zA-Z])/;a.errorCode=d.test(c.text)?"":c.text,e.resetAllStates(),b.go("de.prepaid.content.waiting"),f.showTopUpNotCancelledDialog({text:{message:"db.prepaid.cancel.error.confirmation.message",title:"db.prepaid.cancel.error.confirmation.title",createNew:"db.prepaid.cancel.error.confirmation.create_new",back:"db.prepaid.cancel.error.confirmation.back"},state:{dashboard:"de.dashboard",back:"de.prepaid.form.new"}})})):void formService.dirtyFields(c)})):void b.go("de.prepaid.content.realized")}]),dbnextPrepaidModule.controller("dbnext.prepaid.ContentController",["$rootScope","$state","viewStateService","$scope","prepaidService","recipientsService","translate","prepaidSupplierService","domService","$timeout",function(a,b,c,d,e,f,g,h,i,j){d.$parent.selected={},d.prepaidList={},d.filterOptions={prepaid:""},d.rejectedTabUnseenAmount={count:0},d.currentTabState={},d.stateName=b.current.name,d.details=!1,c.resetInitialState("de.prepaid.form.new"),d.tabs=[{id:"REALIZED",label:"db.prepaid.content.tabs.realized",state:"de.prepaid.content.realized"},{id:"REJECTED",label:"db.prepaid.content.tabs.rejected",state:"de.prepaid.content.rejected"},{id:"TERMINATED",label:"db.prepaid.content.tabs.terminated",state:"de.prepaid.content.canceled"},{id:"ACTIVE",label:"db.prepaid.content.tabs.active",state:"de.prepaid.content.waiting"}],d.$on("$stateChangeStart",function(a,b,e,f,g){"de.prepaid.content.details"==b.name||"de.prepaid.templates"==b.name||"de.prepaid.form.new"==b.name&&"de.prepaid.accept.new"!=f.name?(d.currentTabState.stateName=f.name,c.setInitialState("currentTabState",d.currentTabState)):d.details=!1}),d.translate=function(a){return g.property(a)},d.redoPrepaid=function(a){c.setInitialState("de.prepaid.form.new",{}),e.get(a.prepaidId).then(function(a){var d=a.phoneNo;null!=d&&10==d.length?d=a.phoneNo.substring(1,10):null!=d&&11==d.length&&(d=a.phoneNo.substring(2,11));var e=null,g={mobileOperator:{operatorId:a.networkId},phoneNumber:d,repeatedPhoneNumber:d,remitterAccountId:a.senderAccountId,amount:a.amount};null!=a.templateId&&null!=a.templateName&&(e=f.get(a.templateId).then(function(d){angular.extend(g,{recipientName:a.templateName,templateId:a.templateId,transferFromTemplate:!0}),c.addFormData("de.prepaid.form.new","prepaidForm",{formModel:g}),b.go("de.prepaid.form.new")},function(a){c.addFormData("de.prepaid.form.new","prepaidForm",{formModel:g}),b.go("de.prepaid.form.new")})),null==e&&(c.addFormData("de.prepaid.form.new","prepaidForm",{formModel:g}),b.go("de.prepaid.form.new"))})},d.cancelPrepaid=function(a){c.setInitialState("de.prepaid.cancel",a),b.go("de.prepaid.cancel",{dispositionId:a.prepaidId})},d.prepaidSuppliersPromise=h.search().then(function(a){d.prepaidSuppliers=a.content[0],d.prepaidSuppliers.target=i.isIE()?"":"_blank"}),d.emitTabChange=function(a){d.$broadcast("changeTab",{direction:a})},d.$on("activeTabChanged",function(a,b){d.activeTab={state:b.active.state},d.showForRealized="REALIZED"==b.active.id}),c.resetInitialState("currentTabState")}]),dbnextPrepaidModule.controller("dbnext.prepaid.DetailsController",["$scope","$state","$log","$stateParams","prepaidService","initialState","viewStateService",function(a,b,c,d,e,f,g){a.currentTabState=g.getInitialState("currentTabState"),null==a.currentTabState?a.currentTabState={stateName:"de.prepaid.content.realized"}:g.resetInitialState("currentTabState"),a.$parent.details=!0,angular.isDefined(f)&&null!=f?(angular.isDefined(f.prepaidId)&&(a.prepaidDetailsPromise=e.get(f.prepaidId).then(function(b){a.details=angular.extend(b,{transactionTitle:b.transactionTitle.join("")})},function(b){c.error("Error getting prepaid details"),a.details=null})),null!=f.backState&&void 0!=f.backState&&(a.currentTabState={stateName:f.backState})):b.go("de.prepaid.content.realized"),a.range=function(a){return new Array(a)}}]),dbnextPrepaidModule.controller("dbnext.prepaid.FormController",["$scope","$rootScope","viewStateService","$state","initialState","prepaidService","mobileOperatorsService","formService","notificationService","$timeout","prepaidSupplierService","userService","httpService","language","gate","domService","$filter","events",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a.$parent.details=!0,a.formData={exchangeMessageHidden:!0,formModel:{}};var s=function(b){var c=a.formData.formModel.phoneNumber;return c=c.substring(c.length-9)},t=c.getInitialState(d.current.name);null!=t&&(a.formData=c.getFormData("prepaidForm")||{formModel:{}},a.defaultTemplate=c.getFormData("prepaidTemplate")||null),void 0!=a.formData.formModel.phoneNumber&&a.formData.formModel.phoneNumber.length>9&&(a.formData.formModel.phoneNumber=s(a.formData.formModel.phoneNumber)),void 0!=a.formData.formModel.repeatedPhoneNumber&&a.formData.formModel.repeatedPhoneNumber.length>9&&(a.formData.formModel.repeatedPhoneNumber=s(a.formData.formModel.repeatedPhoneNumber)),a.$watch("formData.formModel.mobileOperator.operatorId",function(b,c){null!=b&&(a.logoPromise=g.get(b,{fields:"operatorLogo"}).then(function(b){a.formData.operatorLogo=b.operatorLogo}),w("phoneNumber"))}),a.controllEvent={},a.controllEvent.value=!1;var u=function(a,b){if(a&&b)for(var c=0;c<a.length;c++)if(a[c]instanceof Array&&b[c]instanceof Array){var d=a[c],e=b[c];if(d.length!=e.length)return!0;for(var f=0;f<d.length;f++)if(d[f]!=e[f])return!0}else if(a[c]!=b[c])return!0;return!1};a.$watch("formData.formModel.amount",function(c){0==c?a.formData.amountWithoutVat=0:j(function(){j(function(){void 0!=b.vatRateData&&b.vatRateData.then(function(b){var c=1+b.vatRate/100,d=parseFloat(a.formData.formModel.amount)/parseFloat(c)*100;d=Math.round(d)/100,a.formData.amountWithoutVat=d})})})}),a.$watch("formData.formModel.transferFromTemplate",function(b,c){b&&(a.formData.formModel.phoneNumber.length>9&&(a.formData.formModel.phoneNumber=s(a.formData.formModel.phoneNumber)),a.formData.formModel.repeatedPhoneNumber.length>9&&(a.formData.formModel.repeatedPhoneNumber=s(a.formData.formModel.repeatedPhoneNumber)),a.templateValues=[a.formData.formModel.mobileOperator.operatorId,a.formData.formModel.phoneNumber])}),a.$watchGroup(["formData.formModel.mobileOperator.operatorId","formData.formModel.phoneNumber"],function(b,c){void 0!=a.templateValues&&void 0!=a.formData.formModel&&u(b,a.templateValues)&&(a.formData.formModel.transferFromTemplate=!1,a.formData.formModel.templateId=""),a.formData.formModel.transferFromTemplate||r.broadcast("eb.recipientSelect.clearSelected"),b&&b[1]&&a.prepaidAddForm&&w("phoneNumber")}),a.$watch("formData.formModel.prepaid",function(b){if(b){var c=a.formData.formModel.amount;"DISCRETE"===b.amountType?b.valueDiscrete!==c&&(a.formData.formModel.amount=b.valueDiscrete):"INTERVAL"===b.amountType&&(b.valueFrom>c||b.valueTo<c)&&(a.formData.formModel.amount=null)}}),a.submit=function(b){return angular.element(document.querySelector(":focus")).triggerHandler("blur"),x(a.formData.formModel.phoneNumber),b.$valid?(c.setInitialState(d.current.name,{}),c.appendFormData("prepaidForm",a.formData),c.setInitialState("de.prepaid.accept.new",a.formData),f.createPrepaidTransfer({operatorId:a.formData.formModel.mobileOperator.operatorId,phoneNumber:a.formData.formModel.phoneNumber,remitterId:a.formData.formModel.remitterId,remitterAccountId:a.formData.formModel.remitterAccountId,amount:a.formData.formModel.amount,templateId:a.formData.formModel.templateId,prepaidFromTemplate:a.formData.formModel.transferFromTemplate}).then(function(a){d.go("de.prepaid.accept.new",{dispositionId:a})},function(a){null!=a&&null!=a.errors&&h.scrollToError(a.errors[0].field)})):void h.dirtyFields(b)},a.currentTabState=c.getInitialState("currentTabState"),null==a.currentTabState&&(a.currentTabState={stateName:"de.prepaid.content.realized"});var v=function(b){var c={resourceId:b.prepaidSupplierRegulationId,prepaidSupplierId:b.prepaidSupplierRegulationId,formatType:"pdf",contentDisposition:"download",language:n.get()};a.prepaidSupplierServicePromise=o.getHref("download_regulations",b).then(function(b){l.getIdentityDetails().then(function(d){a.regulations={link:m.appContext+b+m.serializeParams(angular.extend({customerId:d.id},c),!0),target:p.isIE()?"":"_blank"}})})};a.prepaidSupplierServicePromise=k.search().then(function(a){v(a.content[0])});var w=function(b){if(a.prepaidAddForm[b]&&!a.prepaidAddForm[b].$valid)for(var c in a.prepaidAddForm[b].$error){console.log("Clear validation error: "+c);var d=!1;a.prepaidAddForm[b].$error.hasOwnProperty(c)&&(a.prepaidAddForm[b].$setValidity(c,!0),d=!0),d&&(a.prepaidAddForm[b].$setPristine(),a.prepaidAddForm[b].$setUntouched(),a.prepaidAddForm[b].$validate()),a.prepaidAddForm[b].$modelValue!=a.prepaidAddForm[b].$viewValue&&(a.prepaidAddForm[b].$modelValue=a.prepaidAddForm[b].$viewValue)}},x=function(b){b&&a.prepaidAddForm.phoneNumber.$setValidity("minlength",9==b.length)}}]),dbnextPrepaidModule.controller("dbnext.prepaid.PrepaidInfoController",["$scope","$state","mobileOperatorsService","prepaidService","initialState",function(a,b,c,d,e){a.prepaidInfoList={},a.$parent.details=!0,a.backState=angular.isDefined(e)?e.state:"de.prepaid.content.realized",a.prepaidInfoPromise=c.search({fields:"operatorId,operatorName,aboutUrl,operatorLogo"}).then(function(b){a.prepaidInfoList=b;for(var c=a.prepaidInfoList.content,d=0;d<c.length;d++)c[d].urlPrefix=c[d].aboutUrl&&c[d].aboutUrl.indexOf("http")>-1?"":"//"})}]),dbnextPrepaidModule.controller("dbnext.prepaid.RealizedContentController",["searchWrapperService","$scope","$rootScope","$filter","$log","prepaidService","recipientsService","storageItemsService","domService","httpService","userService","gate","language","viewStateService","$state",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.$parent.selected={},b.prepaidsList={},b.itemsStorageParams={statusPrepaidCriteria:"REJECTED"};var p=function(){b.prepaidsList.content=b.prepaidsList.content.map(function(b){return angular.extend(b,a.wrapPrepaidFields(b))})};b.filterParams=n.getInitialState(o.current.name),null==b.filterParams&&(b.filterParams={statusPrepaidCriteria:"REALIZED"}),b.submit=function(a,c,d){return angular.isDefined(a)?(b.loading=!0,b.prepaidListPromise=f.relationSearch(a,c,d).then(function(a){b.prepaidsList=a,r(a,c),b.loading=!1,b.filterParams.pageNumber=a.pageNumber,b.filterParams.pageSize=a.pageSize,p(),n.setInitialState(o.current.name,b.filterParams)},function(a){e.error("Error getting prepaids list"),b.prepaidsList=[]}),b.prepaidListPromise):void 0},b.prepaidListPromise=f.search(b.filterParams).then(function(a){b.prepaidsList=a,r(a,b.filterParams),b.loading=!1,b.filterParams.pageNumber=a.pageNumber,b.filterParams.pageSize=a.pageSize,p()},function(a){e.error("Error getting prepaids list"),b.prepaidsList=[]}),b.searchPrepaidCount=function(a){f.getPrepaidCount(a).then(function(a){b.rejectedTabUnseenAmount.count=a.count,c.$broadcast("updateTab",{id:"REJECTED",count:b.rejectedTabUnseenAmount.count})})},h.searchItemsFromStorage("dbnext-prepaid.settings").then(function(a){null!=a&&null!=a.content[0]&&(b.itemsStorageParams.realizationDateFrom=a.content[0].value.rejectedTabLastEntryDate,b.searchPrepaidCount(b.itemsStorageParams))}),b.$watch("filterOptions.prepaid",function(a,b){q()});var q=function(){if(null!=b.prepaidsList){b.prepaidsList.summary=[];var a=d("filter")(b.prepaidsList.content,{wrappedText:b.filterOptions.prepaid});b.prepaidsList.summary.push(a)}},r=function(a,b){var c={accountId:b.accountId,formatType:"pdf",language:m.get(),statusPrepaidCriteria:b.statusPrepaidCriteria};l.getHref("download_prepaid_report",a).then(function(b){k.getIdentityDetails().then(function(d){a.link=j.appContext+b+j.serializeParams(angular.extend({customerId:d.id,accessProfileId:d.accessProfileId},c),!0),a.target=i.isIE()?"":"_blank"})})}}]),dbnextPrepaidModule.controller("dbnext.prepaid.RejectedContentController",["searchWrapperService","$scope","$rootScope","$timeout","$filter","$log","prepaidService","recipientsService","storageItemsService","domService","httpService","userService","gate","language","viewStateService","$state",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.$parent.selected={},b.prepaidsList={},b.itemsStorageParams={statusPrepaidCriteria:"REJECTED"};var q=function(){b.prepaidsList.content=b.prepaidsList.content.map(function(b){return angular.extend(b,a.wrapPrepaidFields(b))})};b.filterParams=o.getInitialState(p.current.name),null==b.filterParams&&(b.filterParams={statusPrepaidCriteria:"REJECTED"}),b.submit=function(a,c,d){b.loading=!0,b.prepaidListPromise=g.relationSearch(a,c,d).then(function(a){b.prepaidsList=a,s(a,c),b.loading=!1,b.filterParams.pageNumber=a.pageNumber,b.filterParams.pageSize=a.pageSize,q(),o.setInitialState(p.current.name,b.filterParams)},function(a){f.error("Error getting prepaids list"),b.prepaidsList=[]})},b.prepaidListPromise=g.search(b.filterParams).then(function(a){b.prepaidsList=a,s(a,b.filterParams),b.loading=!1,b.filterParams.pageNumber=a.pageNumber,b.filterParams.pageSize=a.pageSize,q();var c={rejectedTabLastEntryDate:new Date};i.putIntoStorage("dbnext-prepaid.settings",c).then(function(){b.searchItemsFromStorage()})},function(a){f.error("Error getting prepaids list"),b.prepaidsList=[]}),b.searchPrepaidCount=function(a){g.getPrepaidCount(a).then(function(a){b.rejectedTabUnseenAmount.count=a.count,c.$broadcast("updateTab",{id:"REJECTED",count:b.rejectedTabUnseenAmount.count})})},b.searchItemsFromStorage=function(){i.searchItemsFromStorage("dbnext-prepaid.settings").then(function(a){null!=a&&null!=a.content[0]&&(b.itemsStorageParams.realizationDateFrom=a.content[0].value.rejectedTabLastEntryDate,b.searchPrepaidCount(b.itemsStorageParams))})},b.searchItemsFromStorage(),b.$watch("filterOptions.prepaid",function(a,b){r()});var r=function(){if(null!=b.prepaidsList){b.prepaidsList.summary=[];var a=e("filter")(b.prepaidsList.content,{wrappedText:b.filterOptions.prepaid});b.prepaidsList.summary.push(a)}},s=function(a,b){var c={accountId:b.accountId,formatType:"pdf",language:n.get(),statusPrepaidCriteria:b.statusPrepaidCriteria};m.getHref("download_prepaid_report",a).then(function(b){l.getIdentityDetails().then(function(d){a.link=k.appContext+b+k.serializeParams(angular.extend({customerId:d.id,accessProfileId:d.accessProfileId},c),!0),a.target=j.isIE()?"":"_blank"})})}}]),dbnextPrepaidModule.controller("dbnext.prepaid.TemplateAcceptController",["$scope","viewStateService","$state","recipientsService","notificationService","formService",function(a,b,c,d,e,f){a.$parent.details=!0;var g=b.getInitialState(c.current.name);a.formData={isEdition:!1},null!=g&&(a.formData.isEdition=g.isEdition),a.templatePromise=d.templateOrderGet(c.params.templateOrderId).then(function(b){a.templateDetails=b,a.auth={},a.text={auth_method:"db.payments.new.step2.row.auth.label.",no_auth_required:"db.payments.new.step2.row.auth.no_authorization_required",tan_validate_required:"db.payments.new.step2.row.auth.tan.validate.required",sms_validate_required:"db.payments.new.step2.row.auth.sms.validate.required",token_validate_required:"db.payments.new.step2.row.auth.token.validate.required",input_placeholders:"db.prepaid.new.step2.row.auth.placeholder.",error_code_validate:"db.config.auth.error_code.validate."}}),a.accept=function(g){return angular.element(document.querySelector(":focus")).triggerHandler("blur"),g.$valid?a.formData.isEdition?d.templateOrderAction({authenticationAttemptId:a.auth.authenticationAttemptId,credentials:a.auth.credentials,transferId:c.params.templateOrderId},"accept_modification_template",a.templateDetails).then(function(){b.resetAllStates(),c.go("de.prepaid.templates"),e.showTemplateCreatedDialog({text:{title:"db.payments.templates.new.step2.confirmation.title",confirmationText:"db.payments.templates.edition.step2.confirmation.confirmation_text",createNew:"db.payments.templates.new.step2.confirmation.create_new",back:"db.payments.templates.new.step2.confirmation.back"},state:{dashboard:"de.dashboard",templatesForm:"de.prepaid.templatesForm.new"}})},function(b){var c=/([a-zA-Z])/;a.errorCode=c.test(b.text)?"":b.text}):(a.errorCode=null,d.templateOrderAction({authenticationAttemptId:a.auth.authenticationAttemptId,credentials:a.auth.credentials,transferId:c.params.templateOrderId},"accept_creation_template",a.templateDetails).then(function(){b.resetAllStates(),c.go("de.prepaid.templates"),e.showTemplateCreatedDialog({text:{title:"db.payments.templates.new.step2.confirmation.title",confirmationText:"db.payments.templates.new.step2.confirmation.confirmation_text",createNew:"db.payments.templates.new.step2.confirmation.create_new",back:"db.payments.templates.new.step2.confirmation.back"},state:{dashboard:"de.dashboard",templatesForm:"de.prepaid.templatesForm.new"}})},function(b){var c=/([a-zA-Z])/;a.errorCode=c.test(b.text)?"":b.text})):void f.dirtyFields(g)},a.change=function(){b.setInitialState("de.prepaid.templatesForm.new",{correcting:!0}),c.go("de.prepaid.templatesForm.new")}}]),dbnextPrepaidModule.controller("dbnext.prepaid.TemplateDeleteController",["$scope","initialState","pathService","$state","recipientsService","notificationService",function(a,b,c,d,e,f){a.templateDetails={},a.$parent.details=!0;var g=function(){a.templateDeleteDispositionPromise=e.action(a.templateDetails,"remove_template",a.templateDetails).then(function(b){a.templateDeleteDispositionId=b.content,a.auth={},a.text={auth_method:"db.prepaid.auth.label.",no_auth_required:"db.prepaid.auth.no_authorization_required",tan_validate_required:"db.prepaid.auth.tan.validate.required",sms_validate_required:"db.prepaid.auth.sms.validate.required",token_validate_required:"db.prepaid.auth.token.validate.required",error_code_validate:"db.config.auth.error_code.validate."}},function(b){a.back()})};return angular.isDefined(b)?(a.prepaidTemplateDetailsPromise=e.get(b.templateId).then(function(b){a.templateDetails=b,g()},function(b){$log.error("Error getting template details"),a.details=null}),a.accept=function(){e.templateOrderGet(a.templateDeleteDispositionId).then(function(b){var c={authenticationAttemptId:a.auth.authenticationAttemptId,credentials:a.auth.credentials,templateOrderId:a.templateDeleteDispositionId};return a.errorCode=null,e.templateOrderAction(c,"accept_removing_template",b).then(function(a){var b={text:{title:"db.prepaid.templates.delete.confirmation.title",message:"db.prepaid.templates.delete.confirmation.message",back:"db.prepaid.templates.delete.confirmation.back"},state:{dashboard:"de.dashboard"}};f.showTemplateDeletedDialog(b),d.go("de.prepaid.templates")},function(b){var c=/([a-zA-Z])/;a.errorCode=c.test(b.text)?"":b.text})})},void(a.back=function(){d.go("de.prepaid.templates")})):void d.go("de.prepaid.templates")}]),dbnextPrepaidModule.controller("dbnext.prepaid.TemplateDetailsController",["$scope","$log","recipientsService","countryService","costType","initialState","pathService","$state","viewStateService",function(a,b,c,d,e,f,g,h,i){return a.templateDetails={},a.$parent.details=!0,angular.isDefined(f)?void(a.prepaidTemplateDetailsPromise=c.get(f.templateId).then(function(b){a.templateDetails=b},function(a){b.error("Error getting template details")})):void h.go("de.prepaid.templates")}]),dbnextPrepaidModule.controller("dbnext.prepaid.TemplateFormController",["$scope","$rootScope","$timeout","mobileOperatorsService","$state","recipientsService","formService","viewStateService",function(a,b,c,d,e,f,g,h){a.formData={},a.formData.isEdition=!1,a.$parent.details=!0;var i=h.getInitialState(e.current.name);null!=i&&(!angular.isDefined(h.getFormData("templateForm"))||i.isEdition&&!i.correcting?i.isEdition&&null!=i.templateId&&f.get(i.templateId).then(function(b){a.recipient=b;var c=b.paymentTemplates[0];a.formData.isEdition=!0,a.formData.formModel={templateName:c.templateName,phoneNumber:c.paymentDetails.prepaidPhoneNumber,repeatedPhoneNumber:c.paymentDetails.prepaidPhoneNumber,amount:c.amount,operatorId:c.paymentDetails.paymentOperatorId}}):a.formData=h.getFormData("templateForm")||{formModel:{}},i.correcting&&null!=i.templateId&&f.get(i.templateId).then(function(b){a.recipient=b,a.formData.isEdition=!0})),a.$watch("formData.formModel.amount",function(c){void 0!=c&&(0==c?a.formData.amountWithoutVat=0:void 0!=b.vatRateData&&b.vatRateData.then(function(b){var d=1+b.vatRate/100,e=parseFloat(c)/parseFloat(d)*100;e=Math.round(e)/100,a.formData.amountWithoutVat=e}))}),a.$watch("formData.formModel.mobileOperator.operatorId",function(b,c){null!=b&&(a.logoPromise=d.get(b,{fields:"operatorLogo"}).then(function(b){a.formData.operatorLogo=b.operatorLogo}),j("phoneNumber"))}),a.$watch("formData.formModel.prepaid",function(b){if(b){var c=a.formData.formModel.amount;"DISCRETE"===b.amountType?b.valueDiscrete!==c&&(a.formData.formModel.amount=b.valueDiscrete):"INTERVAL"===b.amountType&&(b.valueFrom>c||b.valueTo<c)&&(a.formData.formModel.amount=null)}}),a.$watch("formData.formModel.phoneNumber",function(b,c){b&&b!=c&&a.prepaidTemplateAddForm&&j("phoneNumber")}),a.submit=function(b){return angular.element(document.querySelector(":focus")).triggerHandler("blur"),k(a.formData.formModel.phoneNumber),b.$valid?(h.setInitialState(e.current.name,{}),h.appendFormData("templateForm",a.formData),h.setInitialState("de.prepaid.templateAccept.new",a.formData),a.formData.isEdition?f.templateOrderAction({operatorId:a.formData.formModel.mobileOperator.operatorId,customerId:a.formData.formModel.customerId,accessProfileId:a.formData.formModel.accessProfileId,templateName:a.formData.formModel.templateName,telephoneNumber:a.formData.formModel.phoneNumber,amount:a.formData.formModel.amount},"modify_prepaid_template",a.recipient).then(function(a){e.go("de.prepaid.templateAccept.new",{templateOrderId:a.content})},function(a){null!=a&&null!=a.errors&&g.scrollToError(a.errors[0].field)}):f.templateOrderAction({operatorId:a.formData.formModel.mobileOperator.operatorId,customerId:a.formData.formModel.customerId,accessProfileId:a.formData.formModel.accessProfileId,templateName:a.formData.formModel.templateName,telephoneNumber:a.formData.formModel.phoneNumber,amount:a.formData.formModel.amount},"create_prepaid_template").then(function(a){e.go("de.prepaid.templateAccept.new",{templateOrderId:a.content})},function(a){null!=a&&null!=a.errors&&g.scrollToError(a.errors[0].field)})):void g.dirtyFields(b)};var j=function(b){if(a.prepaidTemplateAddForm[b]&&!a.prepaidTemplateAddForm[b].$valid)for(var c in a.prepaidTemplateAddForm[b].$error){console.log("Clear validation error: "+c);var d=!1;a.prepaidTemplateAddForm[b].$error.hasOwnProperty(c)&&(a.prepaidTemplateAddForm[b].$setValidity(c,!0),d=!0),d&&(a.prepaidTemplateAddForm[b].$setPristine(),a.prepaidTemplateAddForm[b].$setUntouched(),a.prepaidTemplateAddForm[b].$validate()),a.prepaidTemplateAddForm[b].$modelValue!=a.prepaidTemplateAddForm[b].$viewValue&&(a.prepaidTemplateAddForm[b].$modelValue=a.prepaidTemplateAddForm[b].$viewValue)}},k=function(b){b&&a.prepaidTemplateAddForm.phoneNumber.$setValidity("minlength",9==b.length)}}]),dbnextPrepaidModule.controller("dbnext.prepaid.TemplatesController",["$scope","$state","viewStateService","$filter","recipientsService","searchWrapperService","accountsService","notificationService","$timeout",function(a,b,c,d,e,f,g,h,i){a.filterOptions={searchFilter:""},a.templatesList=[],c.resetAllStates(),a.$parent.details=!0,a.isActiveAccess=!1,a.activeAccessChecked=!1;var j=function(){a.isActiveAccess=!1;var b={pageSize:1e4};g.search(b).then(function(b){for(var c=b.content,d=0;d<c.length;d++)if("ACTIVE"==c[d].customerProductData.relationStatus){a.isActiveAccess=!0;break}a.activeAccessChecked=!0})};j();var k=function(){a.templatesList=a.templatesList.map(function(a){return angular.extend(a,f.wrapPrepaidTemplateFields(a))})};a.newPrepaid=function(d){if(a.isActiveAccess){var e=d.paymentDetails.prepaidPhoneNumber.toString();null!=e&&10==d.paymentDetails.prepaidPhoneNumber.toString().length?e=e.substring(1,10):null!=e&&11==d.paymentDetails.prepaidPhoneNumber.toString().length&&(e=e.substring(2,11));var f={formModel:{templateId:d.templateId,recipientName:d.templateName,transferFromTemplate:!0,phoneNumber:e,repeatedPhoneNumber:e,mobileOperator:{operatorId:d.paymentDetails.paymentOperatorId},currency:d.currency||"PLN",amount:d.amount}};c.setInitialState("currentTabState",{stateName:b.current.name}),c.setInitialState("de.prepaid.form.new",{}),c.addFormData("de.prepaid.form.new","prepaidForm",f),
b.go("de.prepaid.form.new")}else a.showOperationdUnavaiableInPassiveModeDialog()},a.prepareEdit=function(d){a.isActiveAccess?(c.setInitialState("de.prepaid.templatesForm.new",{isEdition:!0,templateId:d.templateId}),b.go("de.prepaid.templatesForm.new")):a.showOperationdUnavaiableInPassiveModeDialog()},a.prepareDelete=function(d){if(a.isActiveAccess){var e="de.prepaid.templatesDelete";c.setInitialState(e,d),b.go(e)}else a.showOperationdUnavaiableInPassiveModeDialog()},a.templatesPromise=e.search({filerTemplateTypes:"PHONE_TOP_UP",pageSize:1e4}).then(function(b){for(var c=b.content,d=[],e=c.length-1;e>=0;e--)for(var f=c[e].paymentTemplates.length-1;f>=0;f--)c[e].paymentTemplates[f].recipientName=c[e].recipientName,c[e].paymentTemplates[f].recipientAddress=c[e].recipientAddress,d.push(c[e].paymentTemplates[f]);a.templatesList=d,k()}),a.showOperationdUnavaiableInPassiveModeDialog=function(){var a={text:{title:"db.prepaid.templates.access_denied_in_passive_mode.dialog.title",message:"db.prepaid.templates.access_denied_in_passive_mode.dialog.message",back:"db.prepaid.templates.access_denied_in_passive_mode.dialog.back"},state:{dashboard:"de.dashboard"}};h.showOperationdUnavaiableInPassiveModeDialog(a)},a.newTemplateClickCallback=function(){a.isActiveAccess||(a.showOperationdUnavaiableInPassiveModeDialog(),i(function(){b.go("de.prepaid.templates")}))}}]),dbnextPrepaidModule.controller("dbnext.prepaid.TerminatedContentController",["searchWrapperService","$scope","$rootScope","$filter","$log","prepaidService","recipientsService","storageItemsService","domService","httpService","userService","gate","language","viewStateService","$state",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.$parent.selected={},b.prepaidsList={},b.itemsStorageParams={statusPrepaidCriteria:"REJECTED"};var p=function(){b.prepaidsList.content=b.prepaidsList.content.map(function(b){return angular.extend(b,a.wrapPrepaidFields(b))})};b.filterParams=n.getInitialState(o.current.name),null==b.filterParams&&(b.filterParams={statusPrepaidCriteria:"CANCELED"}),b.submit=function(a,c,d){b.loading=!0,b.prepaidListPromise=f.relationSearch(a,c,d).then(function(a){b.prepaidsList=a,r(a,c),b.loading=!1,b.filterParams.pageNumber=a.pageNumber,b.filterParams.pageSize=a.pageSize,p(),n.setInitialState(o.current.name,b.filterParams)},function(a){e.error("Error getting prepaids list"),b.prepaidsList=[]})},b.prepaidListPromise=f.search(b.filterParams).then(function(a){b.prepaidsList=a,r(a,b.filterParams),b.loading=!1,b.filterParams.pageNumber=a.pageNumber,b.filterParams.pageSize=a.pageSize,p()},function(a){e.error("Error getting prepaids list"),b.prepaidsList=[]}),b.searchPrepaidCount=function(a){f.getPrepaidCount(a).then(function(a){b.rejectedTabUnseenAmount.count=a.count,c.$broadcast("updateTab",{id:"REJECTED",count:b.rejectedTabUnseenAmount.count})})},h.searchItemsFromStorage("dbnext-prepaid.settings").then(function(a){null!=a&&null!=a.content[0]&&(b.itemsStorageParams.realizationDateFrom=a.content[0].value.rejectedTabLastEntryDate,b.searchPrepaidCount(b.itemsStorageParams))}),b.$watch("filterOptions.prepaid",function(a,b){q()});var q=function(){if(null!=b.prepaidsList){b.prepaidsList.summary=[];var a=d("filter")(b.prepaidsList.content,{wrappedText:b.filterOptions.prepaid});b.prepaidsList.summary.push(a)}},r=function(a,b){var c={accountId:b.accountId,formatType:"pdf",language:m.get(),statusPrepaidCriteria:b.statusPrepaidCriteria};l.getHref("download_prepaid_report",a).then(function(b){k.getIdentityDetails().then(function(d){a.link=j.appContext+b+j.serializeParams(angular.extend({customerId:d.id,accessProfileId:d.accessProfileId},c),!0),a.target=i.isIE()?"":"_blank"})})}}]),dbnextPrepaidModule.controller("dbnext.prepaid.ViewController",["$scope",function(a){a.selected={}}]),dbnextPrepaidModule.controller("dbnext.prepaid.WaitingContentController",["searchWrapperService","$scope","$rootScope","$filter","$log","prepaidService","recipientsService","storageItemsService","domService","httpService","userService","gate","language","viewStateService","$state",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.$parent.selected={},b.prepaidsList={},b.itemsStorageParams={statusPrepaidCriteria:"REJECTED"};var p=function(){b.prepaidsList.content=b.prepaidsList.content.map(function(b){return angular.extend(b,a.wrapPrepaidFields(b))})};b.filterParams=n.getInitialState(o.current.name),null==b.filterParams&&(b.filterParams={statusPrepaidCriteria:"WAITING"}),b.submit=function(a,c,d){b.loading=!0,b.prepaidListPromise=f.relationSearch(a,c,d).then(function(a){b.prepaidsList=a,r(a,c),b.loading=!1,b.filterParams.pageNumber=a.pageNumber,b.filterParams.pageSize=a.pageSize,p(),n.setInitialState(o.current.name,b.filterParams)},function(a){e.error("Error getting prepaids list"),b.prepaidsList=[]})},b.prepaidListPromise=f.search(b.filterParams).then(function(a){b.prepaidsList=a,r(a,b.filterParams),b.loading=!1,b.filterParams.pageNumber=a.pageNumber,b.filterParams.pageSize=a.pageSize,p()},function(a){e.error("Error getting prepaids list"),b.prepaidsList=[]}),b.searchPrepaidCount=function(a){f.getPrepaidCount(a).then(function(a){b.rejectedTabUnseenAmount.count=a.count,c.$broadcast("updateTab",{id:"REJECTED",count:b.rejectedTabUnseenAmount.count})})},h.searchItemsFromStorage("dbnext-prepaid.settings").then(function(a){null!=a&&null!=a.content[0]&&(b.itemsStorageParams.realizationDateFrom=a.content[0].value.rejectedTabLastEntryDate,b.searchPrepaidCount(b.itemsStorageParams))}),b.$watch("filterOptions.prepaid",function(a,b){q()});var q=function(){if(null!=b.prepaidsList){b.prepaidsList.summary=[];var a=d("filter")(b.prepaidsList.content,{wrappedText:b.filterOptions.prepaid});b.prepaidsList.summary.push(a)}},r=function(a,b){var c={accountId:b.accountId,formatType:"pdf",language:m.get(),statusPrepaidCriteria:b.statusPrepaidCriteria};l.getHref("download_prepaid_report",a).then(function(b){k.getIdentityDetails().then(function(d){a.link=j.appContext+b+j.serializeParams(angular.extend({customerId:d.id,accessProfileId:d.accessProfileId},c),!0),a.target=i.isIE()?"":"_blank"})})}}]),dbnextPrepaidModule.directive("dbPpdTemplateSelect",["$compile","pathService","recipientsService",function(a,b,c){return{restrict:"EA",replace:!1,scope:{ngModel:"=",selectedTemplate:"=ebSelectedTemplate",ebRequired:"=",onTemplateSelected:"&",placeholder:"@"},templateUrl:b.generateTemplatePath("dbnext-prepaid")+"/directives/dbPpdTemplateSelect/dbPpdTemplateSelect.html",link:function(a,b){function d(){var b=a.definedTemplates=[];e=c.search({filerTemplateType:"PHONE_TOP_UP",pageSize:1e3}).then(function(a){angular.forEach(a.content,function(a){var c=a.paymentTemplates[0];b.push({templateId:c.templateId,templateName:c.templateName,accountId:c.beneficiaryAccountId,phoneNumber:c.paymentDetails.prepaidPhoneNumber,phoneNoPrefix:c.paymentDetails.phoneNumberPrefix,operatorId:c.paymentDetails.paymentOperatorId,networkName:c.paymentDetails.network,currency:c.currency||"PLN",amount:c.amount})})})}var e;d(),b.on("click",function(a){b.querySelectorAll("input.ui-select-search")[0].focus()}),a.selectRecipient=function(b){a.ngModel=b.templateId,a.$eval(a.onTemplateSelected)},a.$watch("ngModel",function(b){b&&e.then(function(){for(var c=a.definedTemplates,d=0;d<c.length;d++){var e=c[d];if(e.templateId===b){a.selectedTemplate=e;break}}})})}}}]),dbnextPrepaidModule.directive("dbPpdTopupSelect",["$compile","$rootScope","pathService","prepaidConfService",function(a,b,c,d){return{restrict:"EA",replace:!1,scope:{ngModel:"=",ebRequired:"=",placeholder:"@",operatorId:"@",template:"=ebTemplate",ebMatchAmount:"=?",ebTemplateCurrency:"=?"},templateUrl:c.generateTemplatePath("dbnext-prepaid")+"/directives/dbPpdTopupSelect/dbPpdTopupSelect.html",link:function(a,c){function e(b){for(var c=0;c<a.prepaidTopupOptions.length;c++){var d=a.prepaidTopupOptions[c];if("DISCRETE"===d.amountType){if(d.valueDiscrete===b){a.selectTopup(d);break}}else if(d.valueFrom<=b&&d.valueTo>=b){a.selectTopup(d);break}c==a.prepaidTopupOptions.length-1&&a.selectTopup(a.prepaidTopupOptions[0])}}a.prepaidTopupOptions=[],null==a.ebTemplateCurrency&&(a.ebTemplateCurrency="PLN"),a.$watch("template",function(c){void 0!=c&&(b.vatRateData=d.search({operatorId:c.operatorId}).then(function(b){return a.prepaidTopupOptions=b.valuePrepaidList,a.ebMatchAmount=c.amount,e(a.ebMatchAmount),b}))}),a.$watch("operatorId",function(c){null!=c&&""!=c&&(b.vatRateData=d.search({operatorId:c}).then(function(b){return a.prepaidTopupOptions=b.valuePrepaidList,e(a.ebMatchAmount),b}))}),a.$watch("ebMatchAmount",function(a){void 0!=a&&e(a)}),c.on("click",function(a){c.querySelectorAll("input.ui-select-search")[0].focus()}),a.selectTopup=function(b){a.ngModel=b}}}}]),dbnextPrepaidModule.controller("dbnext.prepaid.MenuElementController",["$scope","$rootScope",function(a,b){a.isStateActive=b.isStateActive}]),dbnextPrepaidModule.controller("dbnext.prepaid.ProductElementController",["$scope","$state","viewStateService","prepaidService","$log","events","$q",function(a,b,c,d,e,f,g){var h={sortOrder:"REALIZATION_DATE",sortDirection:"DESC",statusPrepaidCriteria:"REALIZED",pageNumber:1,pageSize:1};a.goTo=function(){b.go("de.prepaid.content.realized")},a.prepaidProductPromise=d.search(h).then(function(b){a.prepaidProduct=b.content[0],void 0==a.prepaidProduct&&f.emit("de.product.noData","prepaids",a)},function(a){return e.error("Error getting prepaid product"),g.reject()})}]),dbnextPrepaidModule.controller("dbnext.prepaid.WidgetElementController",["$scope","$state","pathService","recipientsService","$rootScope",function(a,b,c,d,e){a.params={pageNumber:1,pageSize:10,filerTemplateType:"PHONE_TOP_UP"},a.templatePromise=d.search(a.params).then(function(b){a.templateList=b,a.$broadcast("dataLoaded")}),a.submit=function(a,b,c){return d.relationSearch(a,angular.extend(b,{filerTemplateType:"PHONE_TOP_UP"}),c).then(function(a){return a})},a.widgetContent=c.generateTemplatePath("dbnext-prepaid")+"/elements/widget/prepaid-widgetElementViewContent.html",a.prepaid={},a.$watch("prepaid.selected",function(b,c){if(b&&b!=c){var d=b.paymentTemplates[0],e=d.paymentDetails.prepaidPhoneNumber.toString();null!=e&&10==d.paymentDetails.prepaidPhoneNumber.toString().length?e=e.substring(1,10):null!=e&&11==d.paymentDetails.prepaidPhoneNumber.toString().length&&(e=e.substring(2,11)),a.prepaid.template={prepaidForm:{formModel:{templateId:d.templateId,recipientName:d.templateName,transferFromTemplate:!0,phoneNumber:e,repeatedPhoneNumber:e,mobileOperator:{operatorId:d.paymentDetails.paymentOperatorId},currency:d.currency||"PLN",amount:d.amount}}}}})}]),angular.module("dbnext-prepaid").run(["$templateCache",function(a){a.put("templates/dbnext-prepaid/0.0.12/directives/dbPpdTemplateSelect/dbPpdTemplateSelect.html",'<div class="select-searchbox"><ui-select eb-themable close-on-select="true" reset-search-input="true" search-enabled="true" ng-model="$parent.selectedTemplate" theme="select2" ng-disabled="disabled" on-select="selectRecipient($item, $model)" ng-required="ebRequired" name="templateSelect"><ui-select-match placeholder="{{::placeholder|translate}}">{{$select.selected.templateName}}</ui-select-match><ui-select-choices class="block-choices" repeat="template in definedTemplates | filter: $select.search"><div class="prepaid-template"><div class="prepaid-template-details"><div class="template-name">{{template.templateName}}</div><div>{{template.phoneNumber}} | {{template.networkName}}</div></div><eb-amount class="prepaid-template-amount" amount="template.amount" currency="{{ template.currency }}"></eb-amount></div></ui-select-choices></ui-select></div>'),a.put("templates/dbnext-prepaid/0.0.12/directives/dbPpdTopupSelect/dbPpdTopupSelect.html",'<div class="select-searchbox"><ui-select eb-themable close-on-select="true" reset-search-input="true" search-enabled="true" ng-model="$parent.ngModel" theme="select2" ng-disabled="disabled" on-select="selectRecipient($item, $model)" ng-required="ebRequired" name="topupSelect"><ui-select-match placeholder="{{::placeholder|translate}}"><div ng-switch="$select.selected.amountType"><span ng-switch-when="DISCRETE"><eb-amount amount="$select.selected.valueDiscrete" currency="{{ebTemplateCurrency}}"></eb-amount></span> <span ng-switch-when="INTERVAL"><eb-amount class="topup-amount-range" amount="$select.selected.valueFrom" currency="{{ ebTemplateCurrency }}"></eb-amount>&nbsp;-&nbsp;<eb-amount class="topup-amount-range" amount="$select.selected.valueTo" currency="{{ebTemplateCurrency}}"></eb-amount></span></div></ui-select-match><ui-select-choices class="block-choices" repeat="topup in $parent.prepaidTopupOptions | filter: $select.search"><div ng-switch="topup.amountType"><span ng-switch-when="DISCRETE"><eb-amount amount="topup.valueDiscrete" currency="{{ebTemplateCurrency}}"></eb-amount></span> <span ng-switch-when="INTERVAL"><eb-amount class="topup-amount-range" amount="topup.valueFrom" currency="{{ebTemplateCurrency}}"></eb-amount>&nbsp;-&nbsp;<eb-amount class="topup-amount-range" amount="topup.valueTo" currency="{{ebTemplateCurrency}}"></eb-amount></span></div><div class="months">{{::\'db.prepaid.new.step1.range.outgoing\'|translate}}: {{ topup.outAvailabilityValue }} <span eb-variety-msg key="\'db.prepaid.new.step1.row.amount.\' + topup.outAvailabilityType" count="topup.outAvailabilityValue"></span> | {{::\'db.prepaid.new.step1.range.incoming\'|translate}}: {{ topup.inAvailabilityValue }} <span eb-variety-msg key="\'db.prepaid.new.step1.row.amount.\' + topup.inAvailabilityType" count="topup.inAvailabilityValue"></span></div></ui-select-choices></ui-select></div>'),a.put("templates/dbnext-prepaid/0.0.12/elements/menu/prepaid-menuElementView.html",'<li ng-class="{\'active\': isStateActive(\'de.prepaid\')}" ng-controller="dbnext.prepaid.MenuElementController" ui-sref="de.prepaid.content.realized"><span eb-themable class="eb-icon eb-ico-widget-prepaid"></span> <span eb-msg="prepaid.title"></span></li>'),a.put("templates/dbnext-prepaid/0.0.12/elements/product/prepaid-productElementView.html",'<span eb-column-size-class-change-event="column-1"><div ng-controller="dbnext.prepaid.ProductElementController" class="prepaid-product" ng-class="{\'product-content\': !!prepaidProduct}" ng-click="goTo()"><div ng-show="prepaidProductPromise.$$state.status === 1"><div class="prepaid-product-content"><div class="prepaid-product-data"><div class="prepaid-product-header"><span eb-msg="db.prepaid.product.label.last_prepaid"></span></div><div class="prepaid-product-amount" ng-show="prepaidProduct != undefined"><eb-amount amount="prepaidProduct.amount" currency="{{prepaidProduct.currency}}"></eb-amount></div><!-- no whitespace fix --><div class="prepaid-product-operator" ng-show="prepaidProduct != undefined"><span ng-bind="prepaidProduct.networkName"></span></div></div><!-- no whitespace fix --><div class="prepaid-product-icon" ng-show="prepaidProduct != undefined"><span eb-themable class="eb-icon eb-ico-widget-prepaid"></span></div></div></div><div class="prepaid-product-empty" ng-show="prepaidProductPromise.$$state.status === 1 && prepaidProduct == undefined"><div class="prepaid-product-empty-content"><span eb-msg="db.prepaid.product.empty"></span></div></div><eb-preloader class="prepaid-product-preloader" eb-promise="prepaidProductPromise" eb-rejected-message="{{::\'platform.component.slide_widget.rejected_response\'|translate}}"></eb-preloader></div></span>'),a.put("templates/dbnext-prepaid/0.0.12/elements/widget/prepaid-widgetElementView.html",'<span ng-controller="dbnext.prepaid.WidgetElementController" class="widget-main" ng-cloak><span db-lay-tile miniapp-name="dbnext-prepaid" product-count="{{templateList.totalElements}}"><eb-slide-widget content="{{widgetContent}}" items="templateList" max-indicators="10" eb-items-promise="templatePromise" eb-selected-item="prepaid.selected" eb-update="submit(ctx, params, rel)"></eb-slide-widget><div ng-if="templatePromise.$$state.status === 1 && templateList.content.length == 0" class="widget-content"><div class="widget-content-inner info-text"><span eb-msg="db.prepaid.widget.empty_list.marketing_info"></span><br><a href="{{::\'db.prepaid.widget.empty_list.link_url\'|translate}}" target="_blank" ng-click="$event.stopPropagation()"><span eb-msg="db.prepaid.widget.empty_list.link_name"></span></a></div></div><div class="box-action-panel" ng-click="$event.stopPropagation()"><div class="action-button"><eb-button ui-sref="de.prepaid.form.new" store-context="prepaid.template" class="primary icon-right eb-icon eb-ico-plus"><i eb-themable class="eb-icon eb-ico-widget-prepaid prepaid-widget-action-icon widget-action-icon"></i><span eb-msg="db.prepaid.widget.view.new_topup"></span></eb-button></div></div></span></span>'),a.put("templates/dbnext-prepaid/0.0.12/elements/widget/prepaid-widgetElementViewContent.html",'<div class="widget-content"><span class="widget-name">{{ ::item.paymentTemplates[0].templateName }}<br><span>{{::\'db.prepaid.widget.content.phone_number\'|translate}}:&nbsp;{{ ::(item.paymentTemplates[0].paymentDetails.prepaidPhoneNumber | phoneNoFilter:item.paymentTemplates[0].paymentDetails.phoneNumberPrefix) }}</span></span><div><eb-item-property label="db.prepaid.widget.content.network" class="widget-summary big-value not-amount-value value-left">{{::(item.paymentTemplates[0].paymentDetails.network | emptyFilter)}}</eb-item-property><eb-item-property label="db.prepaid.widget.content.amount" class="widget-summary big-value value-right"><eb-amount amount="::item.paymentTemplates[0].amount" currency="{{::(item.paymentTemplates[0].currency || \'PLN\')}}"></eb-amount></eb-item-property></div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidAccept.html",'<div class="step2 inner-form-padding center-form"><div class="panel-details"><eb-section-header eb-header="db.prepaid.new.step2.section_header.header" back-state="{{currentTabState.stateName}}"></eb-section-header><div ng-show="paymentPromise.$$state.status === 1"><div class="form-body form-body-step2" ui-view></div><div class="shaded-section with-data"><eb-responsive-row ng-class="{\'last-row\' : !isAuthorization}" label="db.prepaid.new.step2.row.payment_date" class="new-prepaid-label">{{paymentDetails.realizationDate | dateFilter}}</eb-responsive-row><form name="authForm" novalidate><div eb-authorization eb-model="auth" eb-disposition-id="paymentDetails.prepaidId" eb-resource-type="prepaid" eb-relation="accept_prepaid_transfer" eb-error-code="{{errorCode}}" eb-text="text" eb-form="authForm" is-shown="isAuthorization" eb-show-sms-auth-no="true" eb-disabled="false" eb-required="true"></div><div eb-action-footer cancel-label="db.prepaid.accept.action_footer.cancel_label" submit-label="db.prepaid.accept.action_footer.submit_label" cancel-action="change()" submit-action="accept(authForm)"></div></form></div></div></div><div eb-preloader eb-promise="paymentPromise" class="eb-preloader-default" eb-rejected-message="{{::\'db.prepaid.accept.rejected_response\'|translate}}"></div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidAcceptNew.html",'<eb-responsive-row label="db.prepaid.new.step2.row.beneficiary_name" class="new-prepaid-label"><div ng-repeat="line in paymentDetails.recipientData track by $index">{{line}}</div></eb-responsive-row><eb-responsive-row top label="db.prepaid.new.step2.row.beneficiary_account_no" class="new-prepaid-label"><div>{{ paymentDetails.recipientAccountNo | nrbIbanFilter }}</div><span eb-domestic-bank-details nrb="{{paymentDetails.recipientAccountNo}}"></span></eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.network" class="new-prepaid-label">{{paymentDetails.networkName}}</eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.phone_number" class="new-prepaid-label">{{ paymentDetails.phoneNo | phoneNoFilterWithoutPrefix }}</eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.sender_account" class="new-prepaid-label">{{ paymentDetails.senderAccountNo | nrbIbanFilter }}</eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.sender_name" class="new-prepaid-label"><div>{{ paymentDetails.senderData[0] }}</div><div>{{ paymentDetails.senderData[1] }}</div></eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.amount" class="new-prepaid-label new-payment-step2-amount"><eb-amount amount="paymentDetails.amount" currency="{{ paymentDetails.currency || \'PLN\'}}"></eb-amount></eb-responsive-row><eb-responsive-row top label="db.prepaid.new.step2.row.payment_title" class="new-prepaid-label last-row"><div db-lines-join eb-lines="paymentDetails.transactionTitle"></div></eb-responsive-row>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidCancel.html",'<div class="step2 inner-form-padding center-form"><div class="panel-details"><div ng-show="prepaidPromise.$$state.status === 1"><eb-section-header eb-header="db.prepaid.cancel.section_header.header" back-state="de.prepaid.content.waiting"></eb-section-header><div class="form-body form-body-step2"><eb-responsive-row label="db.prepaid.new.step2.row.beneficiary_name" class="new-prepaid-label"><div ng-repeat="line in prepaidDetails.recipientData track by $index">{{line}}</div></eb-responsive-row><eb-responsive-row top label="db.prepaid.new.step2.row.beneficiary_account_no" class="new-prepaid-label"><div>{{ prepaidDetails.recipientAccountNo | nrbIbanFilter }}</div><span eb-domestic-bank-details nrb="{{prepaidDetails.recipientAccountNo}}"></span></eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.network" class="new-prepaid-label">{{prepaidDetails.networkName}}</eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.phone_number" class="new-prepaid-label">{{ prepaidDetails.phoneNo | phoneNoFilter }}</eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.sender_account" class="new-prepaid-label">{{ prepaidDetails.senderAccountNo | nrbIbanFilter }}</eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.sender_name" class="new-prepaid-label"><div>{{ prepaidDetails.senderData[0] }}</div><div>{{ prepaidDetails.senderData[1] }}</div></eb-responsive-row><eb-responsive-row label="db.prepaid.new.step2.row.amount" class="new-prepaid-label new-payment-step2-amount"><eb-amount amount="prepaidDetails.amount" currency="{{ prepaidDetails.currency || \'PLN\'}}"></eb-amount></eb-responsive-row><eb-responsive-row top label="db.prepaid.new.step2.row.payment_title" class="new-prepaid-label"><div ng-repeat="line in prepaidDetails.transactionTitle track by $index">{{line}}</div></eb-responsive-row></div><div class="shaded-section with-data"><eb-responsive-row ng-class="{\'last-row\' : !isAuthorization}" label="db.prepaid.new.step2.row.payment_date" class="new-prepaid-label">{{prepaidDetails.realizationDate | dateFilter}}</eb-responsive-row><form name="authForm" novalidate><div eb-authorization eb-model="auth" eb-disposition-id="prepaidDetails.prepaidId" eb-resource-type="prepaid" eb-relation="cancel_prepaid_transfer" eb-error-code="{{errorCode}}" eb-text="text" eb-form="authForm" is-shown="isAuthorization" eb-show-sms-auth-no="true" eb-disabled="false" eb-required="true"></div><div eb-action-footer submit-label="db.prepaid.accept.action_footer.submit_cancel_label" cancel-action="change()" submit-action="accept(authForm)"></div></form></div></div></div><div eb-preloader eb-promise="prepaidPromise" class="eb-preloader-default" eb-rejected-message="{{::\'db.prepaid.accept.rejected_response\'|translate}}"></div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidContent.html",'<div eb-themable><eb-mini-bar ng-hide="details" search-text="filterOptions.prepaid" eb-disable-more="true" eb-search-placeholder="{{::\'prepaid.list.filter.options.title\'|translate}}" add-icon-name="eb-ico-widget-prepaid" add-url="de.prepaid.form.new" add-title="{{::\'db.prepaid.content.list.label.new\'|translate}}" left-option-title="{{::\'db.prepaid.content.mini_bar.templates\' | translate}}" left-option-url="de.prepaid.templates" left-option-icon="eb-icon-template"></eb-mini-bar><db-tabs eb-model="filterParams.statusPrepaidCriteria" eb-tabs="tabs" ng-hide="details"></db-tabs><div ui-view autoscroll="true" ng-class="anim_class" ng-swipe-left="emitTabChange(\'left\')" ng-swipe-right="emitTabChange(\'right\')" class="animate-on"></div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidContentTab.html",'<div eb-themable><eb-list id="prepaidListId" class="prepaid-history time-based-list" eb-promise="prepaidListPromise"><div eb-list-item class="row" ng-repeat="prepaid in prepaidsList.content | filter: {wrappedText : filterOptions.prepaid}"><eb-list-item-content class="item-content-with-actions"><div class="date-cell cell_1_in_3"><span>{{prepaid.realizationDate | date : \'dd.MM.yyyy\'}}</span></div><!-- no whitespace fix--><div class="actions-cell"><div class="default-desktop-option"><a href="javascript:void(0)" class="option-row" ui-sref="^.details" store-context="prepaid"><span class="option-label" eb-msg="db.prepaid.content.list.options.label.details"></span></a></div><div class="options"><div eb-list-options><li><a href="javascript:void(0)" class="option-row" ng-click="redoPrepaid(prepaid)"><span eb-themable class="eb-icon eb-ico-widget-prepaid options-icon"></span> <span class="option-label" eb-msg="db.prepaid.content.list.options.redo"></span></a></li><li class="option-hidden-when-desktop"><a href="javascript:void(0)" class="option-row" ui-sref="^.details" store-context="prepaid"><span eb-themable class="eb-icon eb-ico-details options-icon"></span> <span class="option-label" eb-msg="db.prepaid.content.list.options.label.details"></span></a></li><li ng-if="prepaid._links.cancel_prepaid_transfer"><a href="javascript:void(0)" class="option-row" ng-click="cancelPrepaid(prepaid)"><span eb-themable class="eb-icon eb-ico-close options-icon"></span> <span class="option-label" eb-msg="db.prepaid.templates.list.options.cancel"></span></a></li></div></div></div><!-- no whitespace fix--><div class="amount-property-cell cell_3_in_3"><eb-amount amount="prepaid.amount" currency="{{prepaid.currency}}" highlight-negative></eb-amount></div><!-- no whitespace fix--><div class="description-property-cell cell_2_in_3"><div class="prepaid-list-info"><span ng-if="prepaid.templateName">{{prepaid.templateName}}</span> <span ng-if="!prepaid.templateName">{{::"db.prepaid.content.list.template.empty"|translate}}</span> <span class="phone">{{prepaid.phoneNo | phoneNoFilter}}</span></div></div></eb-list-item-content><eb-collapse is-collapsed="prepaid.isCollapsed"><eb-list-details><eb-list-details-item key="db.prepaid.content.list.collapse.network_name" class="transaction-type-label prepaid-type-label-top">{{prepaid.networkName}}</eb-list-details-item><eb-list-details-item key="db.prepaid.content.list.collapse.sender_account" class="transaction-type-label"><eb-account-number nrb="{{prepaid.senderAccountNo}}"></eb-account-number></eb-list-details-item></eb-list-details></eb-collapse></div><div class="miniapp-empty-list" ng-if="prepaidsList.length == 0">{{::"db.prepaid.list_data_error"|translate}}</div><div class="miniapp-empty-list" ng-if="prepaidsList.content.length == 0 || prepaidsList.summary[0].length == 0">{{::"db.prepaid.content.list.empty"|translate}}</div></eb-list><div ng-show="prepaidListPromise.$$state.status === 1 && prepaidsList.totalPages > 1"><eb-pagination eb-data="prepaidsList" eb-params="filterParams" eb-loading="loading" eb-pagination-count="5" scroll-to="prepaidListId" callback="submit(ctx, params, rel)"></eb-pagination></div><eb-options-under-list ng-show="prepaidListPromise.$$state.status === 1"><div class="under-list-option" ng-if="prepaidsList.content.length > 0" ng-class="{\'first-option\': !(prepaidSuppliersPromise.$$state.status === 1), \'second-option\': prepaidSuppliersPromise.$$state.status === 1}"><a href="{{prepaidsList.link}}" target="{{prepaidsList.target}}"><span eb-themable class="eb-icon eb-icon-print options-icon"></span> <span class="option-label" eb-msg="db.prepaid.list.options.downloadList"></span></a></div><div class="under-list-option first-option" ng-if="prepaidsList.content.length > 0" ng-show="prepaidSuppliersPromise.$$state.status === 1"><a href="{{prepaidSuppliers.invoiceUrl}}" target="{{prepaidSuppliers.target}}" ng-show="{{showForRealized}}"><span class="option-label" eb-msg="db.prepaid.list.options.invoice"></span></a></div><div class="left-under-list-option"><a ui-sref="de.prepaid.content.prepaidInfo" store-context="activeTab"><span class="option-label" eb-msg="db.prepaid.list.options.prepaidInfo"></span></a></div></eb-options-under-list></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidDetails.html",'<div eb-themable><eb-section-header eb-header="db.prepaid.details.section_header.header" back-state="{{currentTabState.stateName}}"></eb-section-header><div class="details-body" ng-show="details != null  && prepaidDetailsPromise.$$state.status != 0"><eb-responsive-row label="db.prepaid.details.row.phone_no">{{details.phoneNo | phoneNoFilter}}</eb-responsive-row><eb-responsive-row label="db.prepaid.details.row.network">{{details.networkName}}</eb-responsive-row><eb-responsive-row label="db.prepaid.details.row.beneficiary_name" class="new-prepaid-label" top><div ng-repeat="index in range(4) track by $index">{{details.recipientData[$index]}}</div></eb-responsive-row><eb-responsive-row label="db.prepaid.details.row.beneficiary_account">{{details.recipientAccountNo | nrbIbanFilter}}</eb-responsive-row><eb-responsive-row label="db.prepaid.details.row.sender_account">{{details.senderAccountNo | nrbIbanFilter}}</eb-responsive-row><eb-responsive-row label="db.prepaid.details.row.sender_name" class="new-prepaid-label">{{details.senderData[0]}}</eb-responsive-row><eb-responsive-row label="db.prepaid.details.row.amount"><eb-amount amount="details.amount" currency="{{details.currency}}" highlight-negative></eb-amount></eb-responsive-row><eb-responsive-row ng-if="details.status == \'REJECTED\'" label="db.prepaid.details.row.description" class="new-prepaid-label">{{details.description}}</eb-responsive-row><eb-responsive-row label="db.prepaid.details.row.transfer_title">{{details.transactionTitle}}</eb-responsive-row><eb-responsive-row label="db.prepaid.details.row.execution_date">{{details.realizationDate | date : \'dd.MM.yyyy\' || \'-\' }}</eb-responsive-row></div><div class="miniapp-empty-list" ng-if="details == null && prepaidDetailsPromise.$$state.status != 0">{{::\'db.prepaid.list_data_error\'|translate}}</div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidForm.html",'<div class="center-app-header"><div eb-content-navigation></div><div style="position:relative"><div class="inner-form-padding center-form"><div eb-themable><div eb-section-header eb-header="db.prepaid.new.step1.section_header.header" back-state="{{currentTabState.stateName}}"></div><div class="form-body" eb-view-swap="viewLoaded"><form name="prepaidAddForm" novalidate><div ui-view autoscroll="true"></div><div eb-action-footer submit-label="db.prepaid.new.step1.action_footer.submit" submit-icon="eb-ico-widget-prepaid" submit-action="submit(prepaidAddForm)"></div></form></div><eb-preloader visible class="eb-preloader-default"></eb-preloader></div></div></div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidFormNew.html",'<div eb-responsive-row label="db.prepaid.form.row.recipient_template"><div eb-recipient-select type="prepaid" eb-form="prepaidAddForm" search-limit="10000" eb-name="templateSelect" ng-model="formData.formModel" eb-required="false" template-type="PHONE_TOP_UP" eb-placeholder="{{::\'db.prepaid.form.row.recipient_template.placeholder\'|translate}}" eb-default-template="defaultTemplate" eb-template-active="formData.formModel.transferFromTemplate" controll-change-event="controllEvent.value" eb-max-length="70"></div><div eb-validation-messages eb-name="templateSelect"><div eb-message-key="required"><span eb-msg="db.prepaid.form.row.template_select.validate"></span></div><div eb-message-key="payments.templateId.template.not.found">{{::\'db.prepaid.form.row.template.invalid.not_found\'|translate}}</div><div eb-message-key="payments.recipientName.ELIXIRCharactersOnly"><span eb-msg="db.prepaid.form.row.description.invalid_elixir_characters"></span></div></div></div><div collapse="formData.formModel.mobileOperator.operatorId == null"><div eb-responsive-row center label="db.prepaid.new.step1.row.mobile_network" class="operator-logo"><div ng-show="logoPromise.$$state.status !== 1"><eb-preloader eb-promise="logoPromise" eb-rejected-message="{{formData.formModel.mobileOperator.operatorName}}" class="eb-preloader-small"></eb-preloader></div><img ng-show="logoPromise.$$state.status === 1 && formData.operatorLogo != null" ng-src="data:image/png;base64,{{formData.operatorLogo}}" alt="{{formData.formModel.mobileOperator.operatorName}}"> <span ng-show="logoPromise.$$state.status === 1 && formData.operatorLogo == null">{{formData.formModel.mobileOperator.operatorName}}</span></div></div><div eb-responsive-row label="db.prepaid.templates.new.step1.row.operator_name"><div eb-mobile-operator-select name="mobileOperator" ng-model="formData.formModel.mobileOperator" operator-id="formData.formModel.operatorId" ng-required="true" placeholder="db.prepaid.templates.new.step1.row.operator_name.placeholder"></div><div eb-validation-messages eb-name="mobileOperator"><div eb-message-key="required"><span eb-msg="db.prepaid.template.row.mobileOperator.invalid.required"></span></div></div></div><div eb-responsive-row label="db.prepaid.templates.new.step1.row.phone_number"><input type="text" class="phone-number-input" name="phoneNumber" ng-model="formData.formModel.phoneNumber" ng-required="true" placeholder="{{::db.prepaid.templates.new.step1.row.phone_number.placeholder|translate}}" eb-number-pattern="[0-9]{0,9}"><div eb-validation-messages eb-name="phoneNumber"><div eb-message-key="required"><span eb-msg="db.prepaid.template.row.phoneNumber.invalid.required"></span></div><div eb-message-key="minlength"><span eb-msg="db.prepaid.form.row.phoneNumber.invalid.incorrect.length"></span></div><div eb-message-key="prepaid.smt.error.prepaid.number.incorrect.length"><span eb-msg="db.prepaid.form.row.phoneNumber.invalid.incorrect.length"></span></div><div eb-message-key="prepaid.phoneNumber.validate.number.format.exception"><span eb-msg="db.prepaid.new.step1.error.BLUEMEDIA_WRN_ZLY_FORMAT_NUMERU"></span></div><div eb-message-key="prepaid.phoneNumber.validate.number.value.exception"><span eb-msg="db.prepaid.new.step1.error.BLUEMEDIA_WRN_ZLY_NR_TELEFONU"></span></div><div eb-message-key="prepaid.phoneNumber.error.number.inactive"><span eb-msg="db.prepaid.new.step1.error.BLUEMEDIA_WRN_NR_TELEFONU_NIEAKTYWNY"></span></div></div></div><div eb-responsive-row label="db.prepaid.templates.new.step1.row.phone_number_repeat"><div eb-phone-number-input eb-repeated-phone-number-input name="repeatedPhoneNumber" ng-model="formData.formModel.repeatedPhoneNumber" ng-required="true" phone-number="{{formData.formModel.phoneNumber}}" placeholder="db.prepaid.templates.new.step1.row.phone_number.placeholder"></div><div eb-validation-messages eb-name="repeatedPhoneNumber"><div eb-message-key="required"><span eb-msg="db.prepaid.template.row.repeatedPhoneNumber.invalid.required"></span></div><div eb-message-key="same"><span eb-msg="db.prepaid.template.row.repeatedPhoneNumber.invalid.same"></span></div></div></div><div eb-responsive-row label="db.prepaid.form.row.sender_account"><div eb-account-select name="remitterAccountId" ng-model="formData.formModel.remitterAccountId" account="formData.remitterAccount" ng-required="true" placeholder="{{::\'db.prepaid.new.step1.row.account.placeholder\'|translate}}" account-for-prepaid="true"></div><div eb-validation-messages eb-name="remitterAccountId"><div eb-message-key="required"><span eb-msg="db.prepaid.new.step1.row.account.invalid.required"></span></div><div eb-message-key="contract.contractId.no.permission"><span eb-msg="db.prepaid.new.step1.row.account_select.validate.passive_access"></span></div><div eb-message-key="transfer.remitterAccountId.error.lack.of.access.in.active.mode"><span eb-msg="db.prepaid.new.step1.row.account_select.validate.passive_access"></span></div></div></div><div eb-responsive-row center label="db.prepaid.form.row.sender"><div eb-sender-select ng-model="formData.formModel.remitterId" account-id="{{formData.formModel.remitterAccountId}}" eb-required="true" placeholder="{{::\'db.prepaid.form.row.sender_select.placeholder\'|translate}}"></div><div eb-validation-messages eb-name="senderSelect"><div eb-message-key="required"><span eb-msg="db.prepaid.form.row.sender_select.validate"></span></div></div></div><div collapse="formData.formModel.mobileOperator == null"><div eb-responsive-row label="db.prepaid.new.step1.row.amount"><div eb-prepaid-select ng-model="formData.formModel.prepaid" ng-required="true" name="prepaidSelect" eb-currency="payment.template.currency" operator-id="{{formData.formModel.mobileOperator.operatorId}}" eb-match-amount="formData.formModel.amount" placeholder="{{::\'db.prepaid.new.step1.row.amount.placeholder\'|translate}}"></div><div ng-show="formData.formModel.prepaid == null" eb-validation-messages eb-name="prepaidSelect"><div eb-message-key="required"><span eb-msg="db.prepaid.new.step1.row.amount.invalid.required"></span></div></div><div ng-show="formData.formModel.prepaid.amountType != \'INTERVAL\'" eb-validation-messages eb-name="amount"><div eb-message-key="required"><span eb-msg="db.prepaid.new.step1.row.amount.invalid.required"></span></div><div eb-message-key="transfer.amount.error.exceeds.available.funds.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_available_funds"></span></div><div eb-message-key="transfer.amount.error.exceeds.daily.limit.for.user"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_daily_limit_for_user"></span></div><div eb-message-key="transfer.amount.error.exceeds.single.limit.for.user"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_single_limit_for_user"></span></div><div eb-message-key="transfer.amount.error.exceeds.daily.limit.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_daily_limit_for_agreement"></span></div><div eb-message-key="transfer.amount.error.exceeds.single.limit.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_single_limit_for_agreement"></span></div><div eb-message-key="prepaid.amount.validate.money.value.exception"><span eb-msg="db.prepaid.new.step1.error.BLUEMEDIA_WRN_ZLY_FORMAT_KWOTY"></span></div><div eb-message-key="prepaid.amount.validate.money.value.wrong_for_operator"><span eb-msg="db.prepaid.new.step1.error.BLUEMEDIA_WRN_KWOTA_NIEPOPRAWNA_DLA_OPER"></span></div><div eb-message-key="prepaid.amount.validate.money.value.too_big.too_small"><span eb-msg="db.prepaid.new.step1.error.BLUEMEDIA_WRN_KWOTA_ZA_MALA_LUB_ZA_DUZA"></span></div></div></div><div collapse="formData.formModel.prepaid.amountType != \'INTERVAL\'"><div eb-responsive-row label="db.prepaid.new.step1.row.amount.value" label-for="amount"><div eb-input-amount eb-name="amount" eb-form="prepaidAddForm" account-id="{{formData.formModel.remitterAccountId}}" ng-model="formData.formModel.amount" eb-currency-model="{{payment.template.currency || \'PLN\'}}" eb-fault-amount-msg="{{::\'db.prepaid.new.step1.row.amount.value.invalid.number\'|translate}}" eb-required="true" eb-missing-amount-msg="{{::\'db.prepaid.new.step1.row.amount.value.invalid.required\'|translate}}" eb-min-amount="formData.formModel.prepaid.valueFrom" eb-min-amount-msg="{{::\'db.prepaid.new.step1.row.amount.value.invalid.minAmount\'|translate}}" eb-max-amount="formData.formModel.prepaid.valueTo" eb-max-amount-msg="{{::\'db.prepaid.new.step1.row.amount.value.invalid.maxAmount\'|translate}}"></div><div eb-validation-messages eb-name="amount" style="padding-bottom: 4px"><div eb-message-key="transfer.amount.error.exceeds.available.funds.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_available_funds"></span></div><div eb-message-key="transfer.amount.error.exceeds.daily.limit.for.user"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_daily_limit_for_user"></span></div><div eb-message-key="transfer.amount.error.exceeds.single.limit.for.user"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_single_limit_for_user"></span></div><div eb-message-key="transfer.amount.error.exceeds.daily.limit.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_daily_limit_for_agreement"></span></div><div eb-message-key="transfer.amount.error.exceeds.single.limit.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_single_limit_for_agreement"></span></div><div eb-message-key="transfer_order.amount.DecimalMin"><span eb-msg="db.prepaid.form.row.amount.validate.decimal_min"></span></div><div eb-message-key="transfer_order.amount.DecimalMax"><span eb-msg="db.prepaid.form.row.amount.validate.decimal_max"></span></div><div eb-message-key="prepaid_configuration.amount.error.amount_with_decimal"><span eb-msg="db.prepaid.new.step1.row.amount.validate.amount_with_decimal"></span></div></div></div></div><div eb-responsive-row><div class="vat-info" ng-show="formData.amountWithoutVat != null"><span>{{(formData.formModel.amount | currency:\'\')|| "0.00"}}</span><span class="amount-currency">{{payment.template.currency}}</span> <span eb-msg="db.prepaid.new.step1.row.amount.with.vat"></span> (<span>{{(formData.amountWithoutVat | currency:\'\')|| "0.00"}}</span><span class="amount-currency">{{payment.template.currency}}</span> <span eb-msg="db.prepaid.new.step1.row.amount.without.vat"></span>)</div></div></div><div eb-responsive-row class="last-row" top label="db.prepaid.new.step1.row.regulations"><div eb-checkbox eb-model="formData.regulations" class="regulations-checkbox" eb-name="regulations" eb-required="true" ng-mouseenter="isCheckboxHover = true" ng-mouseleave="isCheckboxHover = false" ng-class="{\'eb-checkbox-hover\' : isCheckboxHover}"></div><span class="regulations-checkbox-label" ng-click="formData.regulations=!formData.regulations" eb-msg="db.prepaid.new.step1.row.agree_on_regulations" ng-mouseenter="isCheckboxHover = true" ng-mouseleave="isCheckboxHover = false"></span><div class="regulations-text"><ul style="list-style-type: disc"><li ng-show="prepaidSupplierServicePromise.$$state.status === 1">{{::\'db.prepaid.new.step1.row.regulations.text.1a\'|translate}}&nbsp;<a href="{{regulations.link}}" target="{{regulations.target}}">{{::\'db.prepaid.new.step1.row.regulations.text.1b\'|translate}}</a>&nbsp;{{::\'db.prepaid.new.step1.row.regulations.text.1c\'|translate}}</li><li>{{::\'db.prepaid.new.step1.row.regulations.text.2\'|translate}}</li><li>{{::\'db.prepaid.new.step1.row.regulations.text.3\'|translate}}</li></ul></div><div eb-validation-messages eb-name="regulations"><div eb-message-key="required"><span eb-msg="db.prepaid.new.step1.row.regulations.no_agreement"></span></div></div></div>'),
a.put("templates/dbnext-prepaid/0.0.12/views/prepaidInfo.html",'<div eb-themable><eb-section-header eb-header="db.prepaid.prepaid_info.section_header.header" back-state="{{backState}}"></eb-section-header><eb-list id="prepaidInfoListId" class="perepaid-info-based-list" eb-promise="prepaidInfoPromise"><div eb-list-item class="row" ng-repeat="operator in prepaidInfoList.content"><eb-list-item-content class="item-content-with-actions"><div class="logo-cell cell_1_in_2"><img ng-show="operator.operatorLogo != null" ng-src="data:image/png;base64,{{operator.operatorLogo}}" alt="{{operator.operatorName}}"> <span ng-show="operator.operatorLogo == null">{{operator.operatorName}}</span></div><!-- no whitespace fix --><div class="actions-cell"><div class="options options_menu" ng-show="operator.aboutUrl"><div eb-list-options><li><a href="{{operator.urlPrefix + operator.aboutUrl}}" target="_blank"><span eb-themable class="eb-icon eb-ico-details options-icon"></span> <span class="option-label" eb-msg="db.prepaid.prepaid_info.options.label.details"></span></a></li></div></div><div class="options_link" ng-show="operator.aboutUrl"><a href="{{operator.urlPrefix + operator.aboutUrl}}" target="_blank"><span eb-msg="db.prepaid.prepaid_info.options.label.details"></span></a></div></div><!-- no whitespace fix --><div class="info-cell cell_2_in_2">{{operator.operatorName}}</div></eb-list-item-content></div><div class="miniapp-empty-list" ng-if="statementsList.content.length == 0">{{::"db.prepaid.prepaid_info.empty_list"|translate}}</div><div class="miniapp-empty-list" ng-if="statementsList.length == 0">{{::"db.prepaid.prepaid_info.list_data_error"|translate}}</div></eb-list></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidTemplateAcceptForm.html",'<div eb-themable class="step2 inner-form-padding center-form"><div class="panel-details"><div eb-section-header ng-if="!formData.isEdition" eb-header="db.prepaid.templates.new.step2.section_header.header" back-state="de.prepaid.templates"></div><div eb-section-header ng-if="formData.isEdition" eb-header="db.prepaid.templates.edit.step2.section_header.header" back-state="de.prepaid.templates"></div><div ng-show="templatePromise.$$state.status === 1"><div class="form-body prepaid-accept"><div ui-view></div></div><div class="shaded-section"><form name="authForm" novalidate><div eb-authorization eb-model="auth" eb-disposition-id="templateDetails.templateOrderId" eb-resource-type="template_order" eb-relation="{{formData.isEdition ? \'accept_modification_template\' : \'accept_creation_template\'}}" eb-error-code="{{errorCode}}" eb-text="text" eb-form="authForm" is-shown="isAuthorization" eb-show-sms-auth-no="true" eb-disabled="false" eb-required="true"></div><div eb-action-footer cancel-label="db.payments.templates.new.step2.action_footer.cancel_label" submit-label="db.payments.templates.new.step2.action_footer.submit_label" cancel-action="change()" submit-action="accept(authForm)"></div></form></div></div></div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidTemplateAcceptFormNew.html",'<div eb-responsive-row label="db.prepaid.templates.accept.row.template_name">{{templateDetails.paymentTemplates[0].templateName}}</div><eb-responsive-row label="db.prepaid.accept.row.operator_name" class="new-prepaid-label">{{templateDetails.paymentTemplates[0].paymentDetails.network}}</eb-responsive-row><eb-responsive-row label="db.prepaid.accept.row.phone_number" class="new-prepaid-label">{{ templateDetails.paymentTemplates[0].paymentDetails.prepaidPhoneNumber | phoneNoFilter }}</eb-responsive-row><eb-responsive-row ng-class="{\'last-row\' : !isAuthorization}" label="db.prepaid.accept.row.amount" class="new-prepaid-label new-payment-step2-amount"><eb-amount amount="templateDetails.paymentTemplates[0].amount" currency="{{ templateDetails.paymentTemplates[0].currency || \'PLN\' }}"></eb-amount></eb-responsive-row>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidTemplateDelete.html",'<div eb-themable><div ng-show="prepaidTemplateDetailsPromise.$$state.status === 1" class="panel-details"><eb-section-header eb-header="{{\'db.prepaid.templates.delete.section_header.header\'|translate}}" back-state="de.prepaid.templates"></eb-section-header><div class="form-body shaded-details-body prepaid-details"><div eb-responsive-row label="db.prepaid.templates.delete.row.template_name">{{templateDetails.paymentTemplates[0].templateName}}</div><div eb-responsive-row label="db.prepaid.templates.delete.row.operator_name" class="new-prepaid-label">{{templateDetails.paymentTemplates[0].paymentDetails.network}}</div><div eb-responsive-row label="db.prepaid.templates.delete.row.phone_number" class="new-prepaid-label">{{ templateDetails.paymentTemplates[0].paymentDetails.prepaidPhoneNumber | phoneNoFilter }}</div><div eb-responsive-row ng-class="{\'last-row\' : !isAuthorization}" label="db.prepaid.templates.delete.row.amount" class="new-prepaid-label new-payment-step2-amount"><eb-amount amount="templateDetails.paymentTemplates[0].amount" currency="{{ templateDetails.paymentTemplates[0].currency || \'PLN\' }}"></eb-amount></div></div><div class="shaded-section"><form name="authForm" novalidate><div eb-authorization eb-model="auth" eb-disposition-id="templateDeleteDispositionId" eb-resource-type="template_order" eb-relation="accept_removing_template" eb-error-code="{{errorCode}}" eb-text="text" eb-form="authForm" is-shown="isAuthorization" eb-show-sms-auth-no="true" eb-disabled="false" eb-required="true"></div><eb-action-footer cancel-label="db.prepaid.templates.delete.accept.back" submit-label="db.prepaid.templates.delete.accept.submit" cancel-action="back()" submit-action="accept()"></eb-action-footer></form></div></div><eb-preloader eb-promise="prepaidTemplateDetailsPromise" class="eb-preloader-default" eb-rejected-message="{{::\'db.prepaid.templates.delete.rejected_response\'|translate}}"></eb-preloader><div class="miniapp-empty-list" ng-if="templateDetails == null">{{::\'db.prepaid.templates.delete.data_error\'|translate}}</div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidTemplateDetails.html",'<div eb-themable><div ng-show="prepaidTemplateDetailsPromise.$$state.status === 1"><eb-section-header eb-header="{{\'db.prepaid.templates.details.section_header.header\'|translate}}" back-state="de.prepaid.templates"></eb-section-header><div class="form-body shaded-details-body prepaid-details"><div eb-responsive-row label="db.prepaid.templates.details.row.template_name">{{templateDetails.paymentTemplates[0].templateName}}</div><div eb-responsive-row label="db.prepaid.templates.details.row.operator_name" class="new-prepaid-label">{{templateDetails.paymentTemplates[0].paymentDetails.network}}</div><div eb-responsive-row label="db.prepaid.templates.details.row.phone_number" class="new-prepaid-label">{{ templateDetails.paymentTemplates[0].paymentDetails.prepaidPhoneNumber | phoneNoFilter }}</div><div eb-responsive-row label="db.prepaid.templates.details.row.amount" class="new-prepaid-label new-payment-step2-amount"><eb-amount amount="templateDetails.paymentTemplates[0].amount" currency="{{ templateDetails.paymentTemplates[0].currency || \'PLN\' }}"></eb-amount></div></div></div><eb-preloader eb-promise="prepaidTemplateDetailsPromise" class="eb-preloader-default" eb-rejected-message="{{::\'db.prepaid.template.details.rejected_response\'|translate}}"></eb-preloader><div class="miniapp-empty-list" ng-if="templateDetails == null">{{::\'db.prepaid.templates.details.data_error\'|translate}}</div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidTemplateForm.html",'<div class="center-app-header"><div eb-content-navigation></div><div style="position:relative"><div class="inner-form-padding center-form"><div eb-themable><eb-section-header ng-if="!formData.isEdition" eb-header="db.prepaid.templates.new.section_header.header" back-state="de.prepaid.templates"></eb-section-header><eb-section-header ng-if="formData.isEdition" eb-header="db.prepaid.templates.edit.section_header.header" back-state="de.prepaid.templates"></eb-section-header><div class="form-body" eb-view-swap="viewLoaded"><form name="prepaidTemplateAddForm" novalidate><div ui-view autoscroll="true"></div><div eb-action-footer submit-label="db.prepaid.templates.new.action_footer.submit_label" submit-icon="eb-icon-template" submit-action="submit(prepaidTemplateAddForm)"></div></form></div><div eb-preloader visible class="eb-preloader-default"></div></div></div></div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidTemplateFormNew.html",'<div eb-responsive-row label="db.prepaid.templates.new.step1.row.template_name"><div eb-template-name-input eb-name="templateName" ng-model="formData.formModel.templateName" placeholder="db.prepaid.templates.new.step1.row.template_name.placeholder"></div><div eb-validation-messages eb-name="templateName"><div eb-message-key="required"><span eb-msg="db.prepaid.template.row.templateName.invalid.required"></span></div><div eb-message-key="transfer.recipientName.error.template_name_already_exist"><span eb-msg="db.prepaid.form.row.template_name.template_name_already_exist"></span></div></div></div><div collapse="formData.formModel.mobileOperator.operatorId == null"><div eb-responsive-row center label="db.prepaid.new.step1.row.mobile_network" class="operator-logo"><div ng-show="logoPromise.$$state.status !== 1"><eb-preloader eb-promise="logoPromise" eb-rejected-message="{{formData.formModel.mobileOperator.operatorName}}" class="eb-preloader-small"></eb-preloader></div><img ng-show="logoPromise.$$state.status === 1 && formData.operatorLogo != null" ng-src="data:image/png;base64,{{formData.operatorLogo}}" alt="{{formData.formModel.mobileOperator.operatorName}}"> <span ng-show="logoPromise.$$state.status === 1 && formData.operatorLogo == null">{{formData.formModel.mobileOperator.operatorName}}</span></div></div><div eb-responsive-row label="db.prepaid.templates.new.step1.row.operator_name"><div eb-mobile-operator-select name="mobileOperator" ng-model="formData.formModel.mobileOperator" operator-id="formData.formModel.operatorId" ng-required="true" placeholder="db.prepaid.templates.new.step1.row.operator_name.placeholder"></div><div eb-validation-messages eb-name="mobileOperator"><div eb-message-key="required"><span eb-msg="db.prepaid.template.row.mobileOperator.invalid.required"></span></div></div></div><div eb-responsive-row label="db.prepaid.templates.new.step1.row.phone_number"><input type="text" class="phone-number-input" name="phoneNumber" ng-model="formData.formModel.phoneNumber" ng-required="true" placeholder="{{::db.prepaid.templates.new.step1.row.phone_number.placeholder|translate}}" eb-number-pattern="[0-9]{0,9}"><div eb-validation-messages eb-name="phoneNumber"><div eb-message-key="required"><span eb-msg="db.prepaid.template.row.phoneNumber.invalid.required"></span></div><div eb-message-key="minlength"><span eb-msg="db.prepaid.template.row.phoneNumber.invalid.incorrect.length"></span></div><div eb-message-key="prepaid.smt.error.prepaid.number.incorrect.length"><span eb-msg="db.prepaid.template.row.phoneNumber.invalid.incorrect.length"></span></div></div></div><div eb-responsive-row label="db.prepaid.templates.new.step1.row.phone_number_repeat"><div eb-phone-number-input eb-repeated-phone-number-input name="repeatedPhoneNumber" ng-model="formData.formModel.repeatedPhoneNumber" ng-required="true" phone-number="{{formData.formModel.phoneNumber}}" placeholder="db.prepaid.templates.new.step1.row.phone_number.placeholder"></div><eb-validation-messages eb-name="repeatedPhoneNumber"><div eb-message-key="required"><span eb-msg="db.prepaid.template.row.repeatedPhoneNumber.invalid.required"></span></div><div eb-message-key="same"><span eb-msg="db.prepaid.template.row.repeatedPhoneNumber.invalid.same"></span></div></eb-validation-messages></div><div collapse="formData.formModel.mobileOperator == null"><div eb-responsive-row label="db.prepaid.new.step1.row.amount"><div eb-prepaid-select ng-model="formData.formModel.prepaid" ng-required="true" name="prepaidSelect" eb-currency="payment.template.currency" operator-id="{{formData.formModel.mobileOperator.operatorId}}" eb-match-amount="formData.formModel.amount" placeholder="{{::\'db.prepaid.new.step1.row.amount.placeholder\'|translate}}"></div><div ng-show="formData.formModel.prepaid == null" eb-validation-messages eb-name="prepaidSelect"><div eb-message-key="required"><span eb-msg="db.prepaid.new.step1.row.amount.invalid.required"></span></div></div><div ng-show="formData.formModel.prepaid.amountType != \'INTERVAL\'" eb-validation-messages eb-name="amount"><div eb-message-key="required"><span eb-msg="db.prepaid.new.step1.row.amount.invalid.required"></span></div><div eb-message-key="transfer.amount.error.exceeds.available.funds.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_available_funds"></span></div><div eb-message-key="transfer.amount.error.exceeds.daily.limit.for.user"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_daily_limit_for_user"></span></div><div eb-message-key="transfer.amount.error.exceeds.single.limit.for.user"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_single_limit_for_user"></span></div><div eb-message-key="transfer.amount.error.exceeds.daily.limit.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_daily_limit_for_agreement"></span></div><div eb-message-key="transfer.amount.error.exceeds.single.limit.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_single_limit_for_agreement"></span></div></div></div><div collapse="formData.formModel.prepaid.amountType != \'INTERVAL\'"><div eb-responsive-row label="db.prepaid.new.step1.row.amount.value" label-for="amount"><div eb-input-amount eb-name="amount" eb-form="prepaidTemplateAddForm" account-id="{{formData.formModel.remitterAccountId}}" ng-model="formData.formModel.amount" eb-currency-model="{{payment.template.currency || \'PLN\'}}" eb-fault-amount-msg="{{::\'db.prepaid.new.step1.row.amount.value.invalid.number\'|translate}}" eb-required="false" eb-missing-amount-msg="{{::\'db.prepaid.new.step1.row.amount.value.invalid.required\'|translate}}" eb-min-amount="formData.formModel.prepaid.valueFrom" eb-min-amount-msg="{{::\'db.prepaid.new.step1.row.amount.value.invalid.minAmount\'|translate}}" eb-max-amount="formData.formModel.prepaid.valueTo" eb-max-amount-msg="{{::\'db.prepaid.new.step1.row.amount.value.invalid.maxAmount\'|translate}}"></div><div eb-validation-messages eb-name="amount" style="padding-bottom: 4px"><div eb-message-key="transfer.amount.error.exceeds.available.funds.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_available_funds"></span></div><div eb-message-key="transfer.amount.error.exceeds.daily.limit.for.user"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_daily_limit_for_user"></span></div><div eb-message-key="transfer.amount.error.exceeds.single.limit.for.user"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_single_limit_for_user"></span></div><div eb-message-key="transfer.amount.error.exceeds.daily.limit.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_daily_limit_for_agreement"></span></div><div eb-message-key="transfer.amount.error.exceeds.single.limit.for.agreement"><span eb-msg="db.prepaid.form.row.amount.validate.exceeds_single_limit_for_agreement"></span></div><div eb-message-key="transfer_order.amount.DecimalMin"><span eb-msg="db.prepaid.form.row.amount.validate.decimal_min"></span></div><div eb-message-key="transfer_order.amount.DecimalMax"><span eb-msg="db.prepaid.form.row.amount.validate.decimal_max"></span></div><div eb-message-key="prepaid_configuration.amount.error.amount_with_decimal"><span eb-msg="db.prepaid.new.step1.row.amount.validate.amount_with_decimal"></span></div></div></div></div><div eb-responsive-row><div class="vat-info"><span>{{(formData.formModel.amount | currency:\'\')|| "0.00"}}</span><span class="amount-currency">{{payment.template.currency}}</span> <span eb-msg="db.prepaid.new.step1.row.amount.with.vat"></span> (<span>{{(formData.amountWithoutVat | currency:\'\')|| "0.00"}}</span><span class="amount-currency">{{payment.template.currency}}</span> <span eb-msg="db.prepaid.new.step1.row.amount.without.vat"></span>)</div></div></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidTemplates.html",'<div eb-themable><div ng-show="activeAccessChecked"><eb-section-header eb-header="db.prepaid.templates.label.header" back-state="de.prepaid.content.realized"></eb-section-header><eb-mini-bar search-text="filterOptions.searchFilter" eb-disable-more="true" eb-search-placeholder="{{::\'db.prepaid.templates.mini_bar.placeholder\'|translate}}" add-icon-name="eb-icon-template" add-url="de.prepaid.templatesForm.new" add-title="{{::\'db.prepaid.templates.mini_bar.title\'|translate}}" click-callback="newTemplateClickCallback"></eb-mini-bar><eb-list id="prepaidTemplatesList" class="template-based-list no-details" eb-promise="templatesPromise"><eb-list-item class="row" ng-repeat="template in filtered = (templatesList | filter: { wrappedText : filterOptions.searchFilter })"><eb-list-item-content class="item-content-with-actions"><div class="prepaid-operator-cell cell_1_in_3"><span>{{template.paymentDetails.network}}</span></div><!-- no whitespace fix--><div class="actions-cell"><div class="default-desktop-option"><a ng-click="newPrepaid(template)"><span eb-msg="db.prepaid.templates.list.options.new_prepaid"></span></a></div><div class="options"><div eb-list-options><li class="option-hidden-when-desktop"><a class="option-row" ng-click="newPrepaid(template)"><span eb-themable class="eb-icon eb-ico-widget-prepaid options-icon"></span> <span class="option-label" eb-msg="db.prepaid.templates.list.options.new_prepaid"></span></a></li><li><a class="option-row" ui-sref="de.prepaid.templatesDetails" store-context="template"><span eb-themable class="eb-icon eb-ico-details options-icon"></span> <span class="option-label" eb-msg="db.prepaid.templates.list.options.details"></span></a></li><li><a class="option-row" ng-click="prepareEdit(template)"><span eb-themable class="eb-icon eb-ico-edit options-icon"></span> <span class="option-label" eb-msg="db.prepaid.templates.list.options.edit"></span></a></li><li><a class="option-row" ng-click="prepareDelete(template)"><span eb-themable class="eb-icon eb-ico-close options-icon"></span> <span class="option-label" eb-msg="db.prepaid.templates.list.options.delete"></span></a></li></div></div></div><!-- no whitespace fix--><div class="amount-property-cell cell_3_in_3"><db-pmt-template-amount amount="template.amount" currency="{{template.currency || \'PLN\'}}"></db-pmt-template-amount></div><!-- no whitespace fix--><div class="info-cell cell_2_in_3"><div class="template-name">{{template.templateName}}</div><div class="beneficiary-account-no">{{template.paymentDetails.prepaidPhoneNumber | phoneNoFilter}}</div></div></eb-list-item-content></eb-list-item><div class="miniapp-empty-list" ng-if="templatesList.length == 0 || filtered.length == 0">{{::"db.prepaid.templates.content.list.empty"|translate}}</div><div class="miniapp-empty-list" ng-if="templatesList == null">{{::"db.prepaid.templates.list_data_error"|translate}}</div></eb-list></div><eb-preloader visible class="eb-preloader-default"></eb-preloader></div>'),a.put("templates/dbnext-prepaid/0.0.12/views/prepaidView.html",'<div eb-full-screen-widget miniapp-name="prepaid"><div class="eb-prepaid"><div eb-screen-content><div ui-view autoscroll="true"></div></div></div></div>')}]);